/*!
*  filename: ej2-kanban.min.js
*  version : 28.2.3
*  Copyright Syncfusion Inc. 2001 - 2024. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("SyncfusionBase"),require("SyncfusionPopups"),require("SyncfusionData"),require("SyncfusionDropdowns"),require("SyncfusionInputs"),require("SyncfusionButtons"),require("SyncfusionNavigations")):"function"==typeof define&&define.amd?define(["SyncfusionBase","SyncfusionPopups","SyncfusionData","SyncfusionDropdowns","SyncfusionInputs","SyncfusionButtons","SyncfusionNavigations"],t):"object"==typeof exports?exports.SyncfusionKanban=t(require("SyncfusionBase"),require("SyncfusionPopups"),require("SyncfusionData"),require("SyncfusionDropdowns"),require("SyncfusionInputs"),require("SyncfusionButtons"),require("SyncfusionNavigations")):e.SyncfusionKanban=t(e.SyncfusionBase,e.SyncfusionPopups,e.SyncfusionData,e.SyncfusionDropdowns,e.SyncfusionInputs,e.SyncfusionButtons,e.SyncfusionNavigations)}(self,((e,t,n,r,a,i,o)=>(()=>{"use strict";var l={766:t=>{t.exports=e},741:e=>{e.exports=i},74:e=>{e.exports=n},778:e=>{e.exports=r},323:e=>{e.exports=a},215:e=>{e.exports=o},197:e=>{e.exports=t}},s={};function d(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return l[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{d.r(c),d.d(c,{Kanban:()=>It,actionBegin:()=>a,actionComplete:()=>i,actionFailure:()=>o,bottomSpace:()=>E,cardClick:()=>l,cardDoubleClick:()=>s,cardRendered:()=>p,cardSpace:()=>k,contentReady:()=>C,dataBinding:()=>u,dataBound:()=>g,dataReady:()=>w,dataSourceChanged:()=>x,dataStateChange:()=>D,dialogClose:()=>S,dialogOpen:()=>b,documentClick:()=>v,drag:()=>f,dragStart:()=>m,dragStop:()=>y,queryCellInfo:()=>h,toggleWidth:()=>O});var e,t=d(766),n=d(197),r=d(74),a="actionBegin",i="actionComplete",o="actionFailure",l="cardClick",s="cardDoubleClick",p="cardRendered",h="queryCellInfo",u="dataBinding",g="dataBound",m="dragStart",f="drag",y="dragStop",v="document-click",b="dialogOpen",S="dialogClose",C="content-ready",w="data-ready",E=25,k=16,O=50,x="dataSourceChanged",D="dataStateChange",A=function(){function e(e){this.initload=!1,this.dataState={isPending:!1,resolver:null,isDataChanged:!1},this.parent=e,this.keyField=this.parent.cardSettings.headerField,this.dataState={isDataChanged:!1},this.isObservable=!1,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof r.DataManager?e:new r.DataManager(e),this.query=t instanceof r.Query?t:new r.Query,this.kanbanData=new r.DataManager(this.parent.kanbanData)},e.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},e.prototype.columnKeyFields=function(){for(var e=[],t=0,n=this.parent.columns;t<n.length;t++){var r=n[t];if(r.keyField.toString().split(",").length>1)for(var a=0,i=r.keyField.toString().split(",");a<i.length;a++){var o=i[a];e.push(o.trim())}else e.push(r.keyField.toString())}return e},e.prototype.getQuery=function(e){var n=this.query.clone();if(this.isRemote()&&this.parent.enableVirtualization){for(var r="auto"===this.parent.cardHeight?100:parseInt((0,t.formatUnit)(this.parent.cardHeight).split("px")[0],10),a="auto"===this.parent.height?2*Math.ceil(window.innerHeight/r):2*Math.ceil(parseInt((0,t.formatUnit)(this.parent.height).split("px")[0],10)/r),i=this.columnKeyFields(),o=0;o<i.length;o++)n.where(this.parent.keyField,"equal",i[o]);n.take(a),(0,t.isNullOrUndefined)(e)&&(e="KanbanVirtualization"),n.addParams("KanbanVirtualization",e)}return n},e.prototype.getData=function(e){if(this.parent.dataSource&&"result"in this.parent.dataSource){var t=this.eventPromise({requestType:""},e);return this.isObservable=!0,t.promise}return this.dataManager.executeQuery(e)},e.prototype.setState=function(e){return this.dataState=e},e.prototype.getStateEventArgument=function(e){var n=new r.UrlAdaptor,a=new r.DataManager({url:"",adaptor:new r.UrlAdaptor}),i=n.processQuery(a,e),o=JSON.parse(i.data);return(0,t.extend)(o,i.pvtData)},e.prototype.eventPromise=function(e,n,a){var i=this,o=e,l=this.getStateEventArgument(n),s=new r.Deferred,d=new r.Deferred;if(void 0!==e.requestType&&!1!==this.dataState.isDataChanged)if(l.action=e,"cardChanged"===e.requestType||"cardRemoved"===e.requestType||"cardCreated"===e.requestType){var c=e;c.promise=d.promise,c.state=l,c.index=a,this.setState({isPending:!0,resolver:d.resolve}),o.endEdit=d.resolve,o.cancelEdit=d.reject,this.parent.trigger(x,c),d.promise.then((function(){i.setState({isPending:!0,resolver:s.resolve}),i.parent.trigger(D,l),c.addedRecords.forEach((function(e){i.parent.kanbanData.push(e)})),c.changedRecords.forEach((function(e){var n=i.parent.kanbanData.filter((function(t){return t[i.parent.cardSettings.headerField]===e[i.parent.cardSettings.headerField]}))[0];(0,t.extend)(n,e)})),c.deletedRecords.forEach((function(e){var t=i.parent.kanbanData.findIndex((function(t){return t[i.parent.cardSettings.headerField]===e[i.parent.cardSettings.headerField]}));i.parent.kanbanData.splice(t,1)}))})).catch((function(){i.parent.hideSpinner()}))}else this.setState({isPending:!0,resolver:s.resolve}),this.parent.trigger(D,l);else this.setState({}),s.resolve(this.parent.dataSource);return s},e.prototype.getTable=function(){return this.parent.query?this.getQuery().fromTable:null},e.prototype.refreshDataManager=function(){var e=this;this.getData(this.getQuery()).then((function(t){return e.dataManagerSuccess(t)})).catch((function(t){return e.dataManagerFailure(t)}))},e.prototype.dataManagerSuccess=function(e,t,n,r){var a=this;this.parent.isDestroyed||(t?(this.updateKanbanData(e),this.parent.enableVirtualization&&this.isRemote()&&this.parent.virtualLayoutModule.refresh()):this.parent.trigger(u,e,(function(e){a.updateKanbanData(e),a.parent.notify(w,{processedData:a.parent.kanbanData}),a.parent.trigger(g,null,(function(){return a.parent.hideSpinner()}))})),this.initload&&(this.parent.layoutModule.refresh(),this.parent.renderTemplates()),this.initload=!0)},e.prototype.updateKanbanData=function(e){var n=(0,t.extend)([],(0,t.isNullOrUndefined)(e.result.result)?e.result:e.result.result,null,!0);if(this.isRemote()&&this.parent.enableVirtualization&&n.length>0&&!(0,t.isNullOrUndefined)(e.result.count))for(var a=this.columnKeyFields(),i=0;i<a.length;i++)e.result.count[i].Key===a[i]&&(this.parent.columnDataCount[a[i]]=e.result.count[i].Value);this.parent.kanbanData=n,this.kanbanData=new r.DataManager(this.parent.kanbanData)},e.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger(o,{error:e},(function(){return t.parent.hideSpinner()}))},e.prototype.updateDataManager=function(e,n,r,a,o,l,s,d,c,p){var h,u=this;this.parent.showSpinner();var g={requestType:r,cancel:!1,addedRecords:n.addedRecords,changedRecords:n.changedRecords,deletedRecords:n.deletedRecords};this.setState({isDataChanged:!0}),this.eventPromise(g,this.query,o),this.parent.trigger(i,g,(function(r){r.cancel||(h=u.syncDataSource(u.dataManager,e,n,a,l,s),u.dataManager.dataSource.offline?u.isObservable||(u.syncDataSource(u.kanbanData,e,n,a,l,s),o=d===c&&p?o-1:o,u.refreshUI(r,o,l),u.parent.enableVirtualization&&u.parent.virtualLayoutModule.refreshColumnData(d,c,r.requestType,a[u.parent.keyField])):h.then((function(e){u.parent.isDestroyed||(u.getData(u.getQuery()).then((function(e){return u.dataManagerSuccess(e,"DataSourceChange",r,o)})).catch((function(e){return u.dataManagerFailure(e)})),"cardCreated"===r.requestType?Array.isArray(e)?u.modifyArrayData(r.addedRecords,e):r.addedRecords[0]=(0,t.extend)(r.addedRecords[0],e):"cardChanged"===r.requestType?Array.isArray(e)?u.modifyArrayData(r.changedRecords,e):r.changedRecords[0]=(0,t.extend)(r.changedRecords[0],e):"cardRemoved"===r.requestType&&(Array.isArray(e)?u.modifyArrayData(r.deletedRecords,e):r.deletedRecords[0]=(0,t.extend)(r.deletedRecords[0],e)),o=d===c&&p?o-1:o,u.refreshUI(r,o,l),u.parent.enableVirtualization&&u.parent.virtualLayoutModule.refreshColumnData(d,c,r.requestType,a[u.parent.keyField]))})).catch((function(e){u.dataManagerFailure(e)})))}))},e.prototype.syncDataSource=function(e,t,n,r,a,i){var o,l=this;switch(t){case"insert":return e.insert(r,this.getTable(),this.getQuery());case"update":return this.parent.enableVirtualization&&!this.parent.dataModule.isRemote()&&a?(o=e.remove(this.keyField,r,this.getTable(),this.getQuery()),o=e.insert(r,this.getTable(),this.getQuery(),e.dataSource.json.findIndex((function(e){return e[l.parent.cardSettings.headerField]===i}))),o):e.update(this.keyField,r,this.getTable(),this.getQuery());case"delete":return e.remove(this.keyField,r,this.getTable(),this.getQuery());case"batch":if(!this.parent.dataModule.isRemote()&&a&&this.parent.enableVirtualization&&r){for(var s=0;s<r.length;s++)o=e.remove(this.keyField,r[s],this.getTable(),this.getQuery());var d=e.dataSource.json.findIndex((function(e){return e[l.parent.cardSettings.headerField]===i}));for(s=0;s<r.length;s++,d++)o=e.insert(r[s],this.getTable(),this.getQuery(),d);return o}return e.saveChanges(n,this.keyField,this.getTable(),this.getQuery());default:return o}},e.prototype.modifyArrayData=function(e,n){if(e.length===n.length)for(var r=0;r<n.length;r++)e[r]=(0,t.extend)(e[r],n[r]);return e},e.prototype.refreshUI=function(e,t,n){var r=this;this.parent.enableVirtualization?(this.parent.virtualLayoutModule.columnData=this.parent.virtualLayoutModule.getColumnCards(),e.addedRecords.forEach((function(a,i){r.parent.virtualLayoutModule.renderCardBasedOnIndex(a,t+i,n,e.requestType)})),e.changedRecords.forEach((function(a){r.parent.virtualLayoutModule.removeCard(a),r.parent.virtualLayoutModule.renderCardBasedOnIndex(a,t,n,e.requestType),r.parent.virtualLayoutModule.isSelectedCard&&r.parent.actionModule.SingleCardSelection(a),r.parent.sortSettings.field&&"Index"===r.parent.sortSettings.sortBy&&"Descending"===r.parent.sortSettings.direction&&t>0?--t:t++})),e.deletedRecords.forEach((function(e){r.parent.virtualLayoutModule.removeCard(e)})),this.parent.virtualLayoutModule.refresh()):(this.parent.layoutModule.columnData=this.parent.layoutModule.getColumnCards(),this.parent.swimlaneSettings.keyField&&(this.parent.layoutModule.kanbanRows=this.parent.layoutModule.getRows(),this.parent.layoutModule.swimlaneData=this.parent.layoutModule.getSwimlaneCards()),e.addedRecords.forEach((function(e,n){r.parent.swimlaneSettings.keyField&&!e[r.parent.swimlaneSettings.keyField]&&(e[r.parent.swimlaneSettings.keyField]=""),r.parent.layoutModule.renderCardBasedOnIndex(e,t+n)})),e.changedRecords.forEach((function(e){r.parent.swimlaneSettings.keyField&&!e[r.parent.swimlaneSettings.keyField]&&(e[r.parent.swimlaneSettings.keyField]=""),r.parent.layoutModule.removeCard(e),r.parent.layoutModule.renderCardBasedOnIndex(e,t),r.parent.layoutModule.isSelectedCard&&r.parent.actionModule.SingleCardSelection(e),r.parent.sortSettings.field&&"Index"===r.parent.sortSettings.sortBy&&"Descending"===r.parent.sortSettings.direction&&t>0?--t:t++})),e.deletedRecords.forEach((function(e){r.parent.layoutModule.removeCard(e)})),this.parent.layoutModule.refresh()),this.parent.renderTemplates(),this.parent.notify(C,{}),this.parent.trigger(g,e,(function(){return r.parent.hideSpinner()}))},e}(),F=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)},function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),M=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},T=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),M([(0,t.Property)()],n.prototype,"keyField",void 0),M([(0,t.Property)()],n.prototype,"textField",void 0),M([(0,t.Property)(!1)],n.prototype,"showEmptyRow",void 0),M([(0,t.Property)(!0)],n.prototype,"showItemCount",void 0),M([(0,t.Property)(!1)],n.prototype,"allowDragAndDrop",void 0),M([(0,t.Property)()],n.prototype,"template",void 0),M([(0,t.Property)("Ascending")],n.prototype,"sortDirection",void 0),M([(0,t.Property)()],n.prototype,"sortComparer",void 0),M([(0,t.Property)(!0)],n.prototype,"showUnassignedRow",void 0),M([(0,t.Property)(!1)],n.prototype,"enableFrozenRows",void 0),n}(t.ChildProperty),j=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},R=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return j(n,e),q([(0,t.Property)(!0)],n.prototype,"showHeader",void 0),q([(0,t.Property)()],n.prototype,"headerField",void 0),q([(0,t.Property)()],n.prototype,"contentField",void 0),q([(0,t.Property)()],n.prototype,"tagsField",void 0),q([(0,t.Property)()],n.prototype,"grabberField",void 0),q([(0,t.Property)()],n.prototype,"footerCssField",void 0),q([(0,t.Property)()],n.prototype,"template",void 0),q([(0,t.Property)("Single")],n.prototype,"selectionType",void 0),n}(t.ChildProperty),L=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),P=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},N=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return L(n,e),P([(0,t.Property)()],n.prototype,"template",void 0),P([(0,t.Property)([])],n.prototype,"fields",void 0),P([(0,t.Property)(null)],n.prototype,"model",void 0),n}(t.ChildProperty),H=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},B=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return H(n,e),I([(0,t.Property)()],n.prototype,"keyField",void 0),I([(0,t.Property)()],n.prototype,"headerText",void 0),I([(0,t.Property)()],n.prototype,"template",void 0),I([(0,t.Property)(!1)],n.prototype,"allowToggle",void 0),I([(0,t.Property)(!0)],n.prototype,"isExpanded",void 0),I([(0,t.Property)()],n.prototype,"minCount",void 0),I([(0,t.Property)()],n.prototype,"maxCount",void 0),I([(0,t.Property)(!0)],n.prototype,"showItemCount",void 0),I([(0,t.Property)(!1)],n.prototype,"showAddButton",void 0),I([(0,t.Property)(!0)],n.prototype,"allowDrag",void 0),I([(0,t.Property)(!0)],n.prototype,"allowDrop",void 0),I([(0,t.Property)([])],n.prototype,"transitionColumns",void 0),n}(t.ChildProperty),U=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},V=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return U(n,e),z([(0,t.Property)()],n.prototype,"text",void 0),z([(0,t.Property)()],n.prototype,"keyFields",void 0),n}(t.ChildProperty),_=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},W=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return _(n,e),K([(0,t.Property)("Index")],n.prototype,"sortBy",void 0),K([(0,t.Property)()],n.prototype,"field",void 0),K([(0,t.Property)("Ascending")],n.prototype,"direction",void 0),n}(t.ChildProperty),Y="e-kanban",Q="e-rtl",X="e-device",G="e-icons",J="e-template",Z="e-swimlane",$="e-kanban-table",ee="e-kanban-header",te="e-header-table",ne="e-header-cells",re="e-header-wrap",ae="e-header-title",ie="e-header-text",oe="e-header-icon",le="e-stacked-header-row",se="e-stacked-header-cell",de="e-content-cells",ce="e-kanban-content",pe="e-content-table",he="e-toggle-header",ue="e-header-row",ge="e-content-row",me="e-swimlane-row",fe="e-swimlane-row-expand",ye="e-swimlane-row-collapse",ve="e-item-count",be="e-card-wrapper",Se="e-card-virtual-wrapper",Ce="e-card",we="e-droppable",Ee="e-drag",ke="e-drop",Oe="e-disabled",xe="e-card-header",De="e-card-content",Ae="e-card-header-caption",Fe="e-card-header-title",Me="e-card-tags",Te="e-card-tag",je="e-card-color",qe="e-card-label",Re="e-card-footer",Le="e-empty-card",Pe="e-card-footer-css",Ne="e-column-expand",He="e-column-collapse",Ie="e-collapse-header-text",Be="e-collapsed",Ue="e-kanban-dialog",ze="e-kanban-form",Ve="e-kanban-error",_e="e-field",Ke="e-target-dragged-clone",We="e-cloned-card",Ye="e-kanban-dragged-card",Qe="e-target-dropped-clone",Xe="e-dropping",Ge="e-kanban-border",Je="e-toggle-visible",Ze="e-multi-card-wrapper",$e="e-target-multi-clone",et="e-column-key",tt="e-selection",nt="e-tooltip-text",rt="e-swimlane-header",at="e-icon-menu",it="e-toolbar-swimlane-name",ot="e-swimlane-overlay",lt="e-swimlane-content",st="e-swimlane-resource",dt="e-limits",ct="e-max-count",pt="e-min-count",ht="e-max-color",ut="e-min-color",gt="e-close",mt="e-popup-content",ft="e-show-add-button",yt="e-show-add-icon",vt="e-show-add-focus",bt="e-frozen-swimlane-row",St="e-frozen-row",Ct=function(){function e(e){this.parent=e,this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}return e.prototype.clickHandler=function(e){var n="."+Ce+",."+oe+",."+ge+"."+me+",."+ft+",."+bt+",."+ge+":not(."+me+") ."+de,r=(0,t.closest)(e.target,n);if(r)if(r.classList.contains(Ce))this.parent.allowKeyboard&&this.parent.keyboardModule.cardTabIndexRemove(),this.cardClick(e);else if(r.classList.contains(oe))this.columnExpandCollapse(e);else if(r.classList.contains(ge)&&r.classList.contains(me))this.rowExpandCollapse(e);else if(r.classList.contains(ft))this.addButtonClick(r);else if(r.classList.contains(bt)){var a=[].slice.call(this.parent.element.querySelectorAll("."+me)),i=this.parent.layoutModule.frozenSwimlaneRow.querySelector("."+G);this.rowExpandCollapse(e,a[this.parent.layoutModule.frozenOrder]),!!i.classList.contains(ye)?(0,t.classList)(i,[fe],[ye]):(0,t.classList)(i,[ye],[fe])}},e.prototype.addButtonClick=function(e){var n=this,r={};if(0===this.parent.kanbanData.length)r[this.parent.cardSettings.headerField]=1;else if("number"==typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]){var a=this.parent.kanbanData.map((function(e){return parseInt(e[n.parent.cardSettings.headerField],10)}));r[this.parent.cardSettings.headerField]=Math.max.apply(Math,a)+1}if(r[this.parent.keyField]=(0,t.closest)(e,"."+de).getAttribute("data-key"),"Index"===this.parent.sortSettings.sortBy&&(r[this.parent.sortSettings.field]=1,(0,t.closest)(e,"."+de).querySelector("."+Ce))){var i="Ascending"===this.parent.sortSettings.direction?e.nextElementSibling.classList.contains(Ge)?e.nextElementSibling.nextElementSibling.lastElementChild:e.nextElementSibling.lastElementChild:e.nextElementSibling.classList.contains(Ge)?e.nextElementSibling.nextElementSibling.firstElementChild:e.nextElementSibling.firstElementChild,o=this.parent.getCardDetails(i);r[this.parent.sortSettings.field]=o[this.parent.sortSettings.field]+1}0!==this.parent.kanbanData.length&&this.parent.swimlaneSettings.keyField&&(0,t.closest)(e,"."+ge).previousElementSibling&&(r[this.parent.swimlaneSettings.keyField]=(0,t.closest)(e,"."+ge).previousElementSibling.getAttribute("data-key")),this.parent.openDialog("Add",r)},e.prototype.doubleClickHandler=function(e){(0,t.closest)(e.target,"."+Ce)&&this.cardDoubleClick(e)},e.prototype.cardClick=function(e,n){var r=this,a=(0,t.closest)(n||e.target,"."+Ce),i=this.parent.getCardDetails(a);if(i){this.parent.activeCardData={data:i,element:a};var o={data:i,element:a,cancel:!1,event:e};this.parent.trigger(l,o,(function(n){if(!n.cancel){if(a.classList.contains(tt)&&"click"===e.type)(0,t.removeClass)([a],tt),r.parent.enableVirtualization?r.parent.virtualLayoutModule.disableAttributeSelection(a):r.parent.layoutModule.disableAttributeSelection(a);else{var i=e.ctrlKey;r.parent.isAdaptive&&r.parent.touchModule&&(i=r.parent.touchModule.mobilePopup&&r.parent.touchModule.tabHold||i),r.cardSelection(a,i,e.shiftKey)}r.parent.isAdaptive&&r.parent.touchModule&&r.parent.touchModule.updatePopupContent();var o=(0,t.closest)(a,"."+de);if(r.parent.allowKeyboard)[].slice.call(o.querySelectorAll("."+Ce)).forEach((function(e){e.setAttribute("tabindex","0")})),r.parent.keyboardModule.addRemoveTabIndex("Remove")}}))}},e.prototype.cardDoubleClick=function(e){var n=this,r=(0,t.closest)(e.target,"."+Ce),a=this.parent.getCardDetails(r);this.parent.activeCardData={data:a,element:r},this.cardSelection(r,!1,!1);var i={data:a,element:r,cancel:!1,event:e};this.parent.trigger(s,i,(function(e){e.cancel||n.parent.dialogModule.openDialog("Edit",i.data)}))},e.prototype.rowExpandCollapse=function(e,n){var r=this,o=e instanceof HTMLElement?e:e.target,l=(0,t.isNullOrUndefined)(n)?o:n,s={cancel:!1,target:o,requestType:"rowExpandCollapse"};this.parent.trigger(a,s,(function(e){if(!e.cancel){var n,a=(0,t.closest)(l,"."+me),s=a.getAttribute("data-key"),d=r.parent.element.querySelector("."+ge+":nth-child("+(a.rowIndex+2)+")"),c=a.querySelector("."+fe+",."+ye),p=!!a.classList.contains(Be);p?((0,t.removeClass)([d,a],Be),(0,t.classList)(c,[fe],[ye]),r.parent.swimlaneToggleArray.splice(r.parent.swimlaneToggleArray.indexOf(s),1),n="0"):((0,t.addClass)([d,a],Be),(0,t.classList)(c,[ye],[fe]),r.parent.swimlaneToggleArray.push(s),n="-1"),c.setAttribute("aria-label",p?s+" Expand":s+" Collapse"),a.setAttribute("aria-expanded",p.toString()),d.setAttribute("aria-expanded",p.toString()),[].slice.call(d.querySelectorAll("."+de)).forEach((function(e){e.setAttribute("tabindex",n)})),r.parent.notify(C,{}),r.parent.trigger(i,{target:o,requestType:"rowExpandCollapse"})}}))},e.prototype.columnExpandCollapse=function(e){var n=this,r=e instanceof HTMLElement?e:e.target,o={cancel:!1,target:r,requestType:"columnExpandCollapse"};this.parent.trigger(a,o,(function(e){if(!e.cancel){var a=(0,t.closest)(r,"."+ne),o=a.cellIndex;n.columnToggle(a);var l=n.parent.element.querySelectorAll("."+ne+"."+Be).length;if(l===n.parent.columns.length-n.hideColumnKeys.length){var s="."+ne+":not(."+se+"):nth-child("+(o+1===l?1:o+2)+")",d=n.parent.element.querySelector(s);(0,t.addClass)([d],Be),n.columnToggle(d)}n.parent.notify(C,{}),n.parent.trigger(i,{target:r,requestType:"columnExpandCollapse"})}}))},e.prototype.columnToggle=function(e){var n=this,r=e.cellIndex,a="."+ge+":not(."+me+")",i=[].slice.call(this.parent.element.querySelectorAll(a)),o="."+$+" col:nth-child("+(r+1)+")",l=e.querySelector("."+Ne+",."+He),s=[].slice.call(this.parent.element.querySelectorAll(o));if(e.classList.contains(Be)){(0,t.removeClass)(s,Be),this.parent.isAdaptive&&(this.parent.enableVirtualization?s.forEach((function(e){return e.style.width=(0,t.formatUnit)(n.parent.virtualLayoutModule.getWidth())})):s.forEach((function(e){return e.style.width=(0,t.formatUnit)(n.parent.layoutModule.getWidth())}))),(0,t.classList)(l,[Ne],[He]);for(var d=function(n){var a=n.querySelector("."+de+":nth-child("+(r+1)+")");(0,t.removeClass)([a,e],Be),(0,t.remove)(a.querySelector("."+Ie)),e.setAttribute("aria-expanded","true"),a.setAttribute("aria-expanded","true"),[].slice.call(a.parentElement.querySelectorAll("."+Be)).forEach((function(e){var t=e.querySelector("."+Ie);t.style.height="auto",t&&a.getBoundingClientRect().height<t.getBoundingClientRect().height+10&&(t.style.height=a.getBoundingClientRect().height-4+"px")}))},c=0,p=i;c<p.length;c++){d(p[c])}0===this.parent.kanbanData.length&&0===i.length&&((0,t.removeClass)([e],Be),e.setAttribute("aria-expanded","true")),this.columnToggleArray.splice(this.columnToggleArray.indexOf(e.getAttribute("data-key")),1),this.parent.columns[r].setProperties({isExpanded:!0},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",e.getAttribute("data-key")+" Expand")}else{(0,t.addClass)(s,Be),this.parent.isAdaptive&&s.forEach((function(e){return e.style.width=(0,t.formatUnit)(O)})),(0,t.classList)(l,[He],[Ne]);for(var h=e.getAttribute("data-key"),u=function(n){var r=n.querySelector("."+de+'[data-key="'+h+'"]'),a=r.cellIndex,i=void 0;if(g.parent.enableVirtualization){var o=g.parent.dataModule.isRemote()?g.parent.columnDataCount[g.parent.columns[a].keyField]:g.parent.virtualLayoutModule.columnData[g.parent.columns[a].keyField].length;i=(g.parent.columns[a].showItemCount?"["+o+"] ":"")+g.parent.columns[a].headerText}else i=(g.parent.columns[a].showItemCount?"["+r.querySelectorAll("."+Ce).length+"] ":"")+g.parent.columns[a].headerText;r.appendChild((0,t.createElement)("div",{className:Ie,innerHTML:i})),(0,t.addClass)([r,e],Be),e.setAttribute("aria-expanded","false"),r.setAttribute("aria-expanded","false"),[].slice.call(r.parentElement.querySelectorAll("."+Be)).forEach((function(e){var t=e.querySelector("."+Ie);t&&r.getBoundingClientRect().height<t.getBoundingClientRect().height+10&&(t.style.height=r.getBoundingClientRect().height-4+"px")}))},g=this,m=0,f=i;m<f.length;m++){u(f[m])}0===this.parent.kanbanData.length&&0===i.length&&((0,t.addClass)([e],Be),e.setAttribute("aria-expanded","false")),this.columnToggleArray.push(e.getAttribute("data-key")),this.parent.columns[r].setProperties({isExpanded:!1},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",h+" Collapse")}},e.prototype.cardSelection=function(e,n,r){var a=this;if(e){var i=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var o=(0,t.closest)(e,"."+ge);if(((0,t.isNullOrUndefined)(this.lastSelectionRow)?o.rowIndex:this.lastSelectionRow.rowIndex)!==o.rowIndex&&(n||r)&&"Multiple"===this.parent.cardSettings.selectionType)return;if(0===i.length||n&&"Single"!==this.parent.cardSettings.selectionType||((0,t.removeClass)(i,tt),this.parent.enableVirtualization?this.parent.virtualLayoutModule.disableAttributeSelection(i):this.parent.layoutModule.disableAttributeSelection(i),i.forEach((function(e){a.selectionArray.splice(a.selectionArray.indexOf(e.getAttribute("data-id")),1),a.selectedCardsElement.splice(a.selectedCardsElement.indexOf(e),1),a.selectedCardsData.splice(a.selectedCardsData.indexOf(a.parent.getCardDetails(e),1))}))),i.length>0&&r&&"Multiple"===this.parent.cardSettings.selectionType){var l=[],s=void 0,d=void 0,c=void 0,p=[].slice.call(o.querySelectorAll("."+Ce));p.forEach((function(e){return l.push(e.getAttribute("data-id"))}));var h=e.getAttribute("data-id"),u=this.lastCard.getAttribute("data-id"),g=d=l.indexOf(h),m=s=l.indexOf(u),f=g>m?"next":"prev";for("prev"===f&&(s=g,d=m),c=s;c<=d;c++){var y=p[c];(0,t.addClass)([y],tt),y.setAttribute("aria-selected","true"),y.setAttribute("tabindex","0"),this.selectionArray.push(y.getAttribute("data-id")),this.selectedCardsElement.push(y),this.selectedCardsData.push(this.parent.getCardDetails(y)),this.lastCardSelection=y,"prev"===f&&(this.lastCardSelection=p[s])}}else if((0,t.addClass)([e],tt),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=(0,t.closest)(e,"."+ge),this.lastSelectionRow.previousElementSibling){var v="."+fe+",."+ye,b=this.lastSelectionRow.previousElementSibling.querySelector(v);b&&b.classList.contains(ye)&&this.rowExpandCollapse(b)}}}},e.prototype.addColumn=function(e,n){var r=(0,t.createInstance)(B,[this.parent,"columns",e,!0]);this.parent.columns.splice(n,0,r),this.parent.notify(w,{processedData:this.parent.kanbanData})},e.prototype.deleteColumn=function(e){var n=this.parent.element.querySelectorAll("."+ne).item(e);n&&n.classList.contains(he)&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(n.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?((0,t.detach)(this.parent.element.querySelector("."+ee)),(0,t.detach)(this.parent.element.querySelector("."+ce))):this.parent.notify(w,{processedData:this.parent.kanbanData})},e.prototype.showColumn=function(e){var t=this.hideColumnKeys.indexOf(e.toString());-1!==t&&(this.hideColumnKeys.splice(t,1),this.parent.notify(w,{processedData:this.parent.kanbanData}))},e.prototype.hideColumn=function(e){this.hideColumnKeys.push(e.toString()),this.parent.notify(w,{processedData:this.parent.kanbanData})},e.prototype.SingleCardSelection=function(e){if("None"!==this.parent.cardSettings.selectionType&&e[this.parent.cardSettings.headerField]){var n=this.parent.element.querySelector('.e-card[data-id="'+e[this.parent.cardSettings.headerField].toString()+'"]');n&&((0,t.addClass)([n],tt),n.setAttribute("aria-selected","true"),n.setAttribute("tabindex","0"))}},e}(),wt=function(){function e(e){this.parent=e}return e.prototype.addCard=function(e,t){var n=this,r={cancel:!1,requestType:"cardCreate",addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]};this.parent.trigger(a,r,(function(r){if(!r.cancel){var a=[];n.parent.sortSettings.field&&"Index"===n.parent.sortSettings.sortBy&&(e instanceof Array?a=e:a.push(e),a.forEach((function(e,t){if(!e[n.parent.sortSettings.field]){var r=n.parent.getColumnData(e[n.parent.keyField]);"Ascending"===n.parent.sortSettings.direction&&r.length>0?e[n.parent.sortSettings.field]=r[r.length-1][n.parent.sortSettings.field]+t+1:"Descending"===n.parent.sortSettings.direction&&r.length>0&&(e[n.parent.sortSettings.field]=r[0][n.parent.sortSettings.field]+t+1),0===r.length&&(e[n.parent.sortSettings.field]=1)}})),e instanceof Array||t||"Descending"!==n.parent.sortSettings.direction||n.parent.getColumnData(a[0][n.parent.keyField]).filter((function(e,r){e[n.parent.sortSettings.field]===a[0][n.parent.sortSettings.field]&&(t=r+1)})),0===t||t||"Descending"!==n.parent.sortSettings.direction||(t=0),a=n.priorityOrder(a,t));var i={addedRecords:e instanceof Array?e:[e],changedRecords:n.parent.sortSettings.field&&"Index"===n.parent.sortSettings.sortBy?a:[],deletedRecords:[]},o=e instanceof Array||a.length>0?"batch":"insert";n.parent.dataModule.updateDataManager(o,i,"cardCreated",e,t)}}))},e.prototype.getIndexFromData=function(e){var n=this.parent.element.querySelector("."+Ce+'[data-id="'+e[this.parent.cardSettings.headerField]+'"]'),r=(0,t.closest)(n,"."+de);return[].slice.call(r.querySelectorAll("."+Ce)).indexOf(n)},e.prototype.updateCard=function(e,n,r,i,o,l,s){var d=this,c={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};n=(0,t.isNullOrUndefined)(n)?this.getIndexFromData(c.changedRecords[0]):n,this.parent.trigger(a,c,(function(t){if(!t.cancel){if(d.parent.sortSettings.field&&"Index"===d.parent.sortSettings.sortBy){var a=[];e instanceof Array?a=e:a.push(e),e=d.priorityOrder(a,n)}var c={addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]},p=e instanceof Array?"batch":"update";d.parent.dataModule.updateDataManager(p,c,"cardChanged",e,n,r,i,o,l,s)}}))},e.prototype.deleteCard=function(e){var t=this,n={addedRecords:[],changedRecords:[],deletedRecords:[]};n.deletedRecords="string"==typeof e||"number"==typeof e?this.parent.kanbanData.filter((function(n){return n[t.parent.cardSettings.headerField]===e})):e instanceof Array?e:[e];var r={requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:n.deletedRecords};this.parent.trigger(a,r,(function(e){if(!e.cancel){var r=n.deletedRecords.length>1?"batch":"delete",a=n.deletedRecords;t.parent.dataModule.updateDataManager(r,n,"cardRemoved",a[0])}}))},e.prototype.priorityOrder=function(e,n){for(var r,a=this,i=e.map((function(e){return e[a.parent.cardSettings.headerField]})),o=e[e.length-1][this.parent.sortSettings.field],l=e.map((function(e){return e[a.parent.keyField]})),s=l.filter((function(e,t){return l.indexOf(e)===t})).sort(),d=[],c=[],p=function(l){var s=e.filter((function(e){return e[a.parent.keyField]===l}));r=h.parent.enableVirtualization?h.parent.virtualLayoutModule.getColumnData(l):h.parent.layoutModule.getColumnData(l);for(var p=0,u=s;p<u.length;p++){var g=u[p];if(h.parent.swimlaneSettings.keyField){var m=h.parent.getSwimlaneData(g[h.parent.swimlaneSettings.keyField]);r=h.parent.getColumnData(l,m)}}if(s.forEach((function(e){return d.push(e)})),!(0,t.isNullOrUndefined)(n)){for(var f=function(e){r.filter((function(t,r){t[a.parent.cardSettings.headerField]===i[e]&&r<=n&&c.push(r)}))},y=0;y<i.length;y++)f(y);if(c.length>0&&(n+=c.length),"Ascending"===h.parent.sortSettings.direction)for(var v=n;v<r.length;v++)-1===i.indexOf(r[v][h.parent.cardSettings.headerField])&&(r[v][h.parent.sortSettings.field]=++o,d.push(r[v]));else for(v=n-1;v>=0;v--)-1===i.indexOf(r[v][h.parent.cardSettings.headerField])&&(r[v][h.parent.sortSettings.field]=++o,d.push(r[v]))}},h=this,u=0,g=s;u<g.length;u++){p(g[u])}return d},e}(),Et=function(){function e(e){this.insertClone="afterend",this.parent=e,this.dragObj={element:null,cloneElement:null,instance:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[],modifiedData:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1},this.isDragging=!1,this.isExternalDrop=!1}return e.prototype.wireDragEvents=function(e){var n;null!=!this.parent.element&&0===this.parent.externalDropId.length&&(n=this.parent.element.querySelector("."+ce)),this.dragObj.instance=new t.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:n,dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)})},e.prototype.dragHelper=function(e){if(this.parent.isAdaptive&&this.parent.touchModule.mobilePopup&&this.parent.touchModule.mobilePopup.element.classList.contains("e-popup-open")&&this.parent.touchModule.mobilePopup.hide(),this.dragObj.element=(0,t.closest)(e.sender.target,"."+Ce),(0,t.isNullOrUndefined)(this.dragObj.element))return null;this.dragObj.element.style.width=(0,t.formatUnit)(this.dragObj.element.offsetWidth);var n=(0,t.createElement)("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=n.children.item(0),(0,t.addClass)([this.dragObj.cloneElement],We),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=(0,t.createElement)("div",{className:$e}),this.dragObj.targetClone=(0,t.createElement)("div",{className:Qe,styles:"width:100%;height:"+(0,t.formatUnit)(this.dragObj.element.offsetHeight)}),this.dragObj.modifiedData=[],this.dragObj.cloneElement},e.prototype.dragStart=function(e){var n=this;if(this.dragObj.selectedCards=this.dragObj.element,this.borderElm=this.parent.element.querySelectorAll("."+Ge),this.dragObj.element.classList.contains(tt)){var r="."+Ce+"."+tt+":not(."+We+")",a=(0,t.closest)(this.dragObj.element,"."+ge);this.dragObj.selectedCards=[].slice.call(a.querySelectorAll(r)),this.dragObj.selectedCards.forEach((function(e){n.dragObj.cardDetails.push(n.parent.getCardDetails(e))}))}else this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)];!(0,t.isNullOrUndefined)(this.dragObj.selectedCards)&&!(0,t.isNullOrUndefined)(this.dragObj.selectedCards.length)&&this.dragObj.selectedCards.length>=1?this.dragObj.selectedCards[0].closest(".e-content-cells").classList.add("e-dragged-column"):(0,t.isNullOrUndefined)(this.dragObj.selectedCards)||(0,t.isNullOrUndefined)(this.dragObj.selectedCards.closest(".e-content-cells"))||this.dragObj.selectedCards.closest(".e-content-cells").classList.add("e-dragged-column");var i={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger(m,i,(function(r){if(r.cancel)return n.removeElement(n.dragObj.cloneElement),n.dragObj.instance.intDestroy(e),n.dragObj.element=null,n.dragObj.targetClone=null,n.dragObj.draggedClone=null,n.dragObj.cloneElement=null,void(n.dragObj.targetCloneMulti=null);if(n.dragObj.element.classList.contains(tt)){if(n.dragObj.selectedCards.forEach((function(e){n.draggedClone(e)})),n.dragObj.selectedCards.length>1){n.dragObj.cloneElement.innerHTML="";var a=(0,t.createElement)("div",{className:"e-multi-card-text",innerHTML:n.dragObj.selectedCards.length+" "+n.parent.localeObj.getConstant("cards")});n.dragObj.cloneElement.appendChild(a),(0,t.classList)(n.dragObj.cloneElement,["e-multi-card-clone"],[tt]),n.parent.enableVirtualization?n.parent.virtualLayoutModule.disableAttributeSelection(n.dragObj.cloneElement):n.parent.layoutModule.disableAttributeSelection(n.dragObj.cloneElement),n.dragObj.cloneElement.style.width="90px"}}else n.draggedClone(n.dragObj.element);t.EventHandler.add(document.body,"keydown",n.keydownHandler,n),n.parent.notify(C,{})}))},e.prototype.draggedClone=function(e){this.dragObj.draggedClone=(0,t.createElement)("div",{className:Ke,styles:"width:"+(0,t.formatUnit)(e.offsetWidth-1)+";height:"+(0,t.formatUnit)(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),(0,t.addClass)([e],Ye)},e.prototype.drag=function(e){var n=this;if(e.target){var r=(0,t.closest)(e.target,"."+Y+" ."+Ce);(0,t.isNullOrUndefined)(r)||!this.parent.enableVirtualization||(0,t.isNullOrUndefined)(e.target.previousElementSibling)||(0,t.isNullOrUndefined)(e.target.previousElementSibling.querySelector(".e-target-dropped-clone"))||(r=e.target.previousElementSibling.querySelector(".e-target-dropped-clone").nextElementSibling);var a=e.target;(0,t.isNullOrUndefined)(e.target.parentElement)||("SPAN"===e.target.nodeName&&e.target.classList.contains("e-empty-card")||"DIV"===e.target.nodeName&&e.target.classList.contains("e-kanban-border")&&this.parent.element.querySelector(".e-target-dropped-clone")!==e.target.nextElementSibling.firstChild)&&(a=e.target.parentElement);var i,o,l,s=r||a,d="."+ge+":not(."+me+") ."+de+"."+we,c=(0,t.closest)(s,d);if(s.nextElementSibling&&s.nextElementSibling.lastChild&&(l=s.nextElementSibling.lastChild.previousElementSibling),this.externalDrop(s),this.kanbanObj=this.parent.isExternalKanbanDrop?this.parent.externalDropObj:this.parent,this.calculateArgs(e),c&&"not-allowed"!==document.body.style.cursor){var p=this.getColumnKey(c),h=p.split(",");this.multiCloneRemove();var u=p===this.getColumnKey((0,t.closest)(this.dragObj.draggedClone,"."+de));if(1===h.length||u)if(s.classList.contains(Ke)&&this.removeElement(this.dragObj.targetClone,this.kanbanObj),s.classList.contains(Ce)||"beforebegin"===this.insertClone){var g=s.classList.contains(Ke)&&s.previousElementSibling.classList.contains(Ye)?null:s.previousElementSibling;if(this.insertClone="afterend",(0,t.isNullOrUndefined)(g)){var m=s.classList.contains(Ke)?this.dragObj.pageY/2:this.dragObj.pageY,y=s.classList.contains(Ke)?s.offsetHeight:s.offsetHeight/2;m-(this.kanbanObj.element.getBoundingClientRect().top+s.offsetTop)<y&&(this.insertClone="beforebegin")}s.classList.contains(Ce)&&(this.parent.enableVirtualization&&(this.insertClone=this.isTargetElementVisible(s)?this.insertClone:"beforebegin"),s.insertAdjacentElement(this.insertClone,this.dragObj.targetClone))}else if(s.classList.contains(de)&&!(0,t.closest)(s,"."+me)){if(0!==s.querySelectorAll("."+Ye).length&&0===s.querySelectorAll("."+Ce+":not(.e-kanban-dragged-card):not(.e-cloned-card)").length)return;s.querySelector("."+be).appendChild(this.dragObj.targetClone)}else!s.classList.contains(be)&&!s.classList.contains(Se)||(0,t.closest)(s,"."+me)||0!==c.querySelectorAll("."+Ce).length?!(s.classList.contains(Ge)&&!(0,t.closest)(s,"."+me)&&s.nextElementSibling&&s.nextElementSibling.classList.contains(be)&&this.dragObj.targetClone)||l&&l.classList.contains(Qe)||this.parent.enableVirtualization||this.isTargetElementVisible(s.nextElementSibling)||s.nextElementSibling.appendChild(this.dragObj.targetClone):s.appendChild(this.dragObj.targetClone);else h.length>1&&(c.classList.contains(Xe)||c.firstChild&&c.firstChild.classList.contains(Xe))&&this.multiCloneCreate(h,c);this.kanbanObj.notify(C,{})}0===this.kanbanObj.element.querySelectorAll("."+Xe).length&&this.cellDropping();var v=!1;c&&(v=c.classList.contains(Be)&&c.classList.contains(Xe),"true"!==c.getAttribute("aria-expanded")&&c.parentElement.hasAttribute("aria-expanded")||(i=c.getBoundingClientRect(),this.updateDimension(i)),o=c.querySelector("."+Ge)),s&&"TABLE"===s.tagName&&!(0,t.isNullOrUndefined)(s.querySelector("."+ge))&&(i=s.querySelector("."+ge).getBoundingClientRect(),this.updateDimension(i,s)),v&&(this.toggleVisible(s),(0,t.addClass)([c],Je));var b=[].slice.call(this.kanbanObj.element.querySelectorAll("."+Je));b.length>0&&!s.classList.contains(Je)&&!(0,t.closest)(s,"."+Je)&&(this.toggleVisible(s,b.slice(-1)[0]),(0,t.removeClass)(b,Je)),this.kanbanObj.notify(C,{});var S=(0,t.closest)(s,"."+et);if(S){var w=[].slice.call(this.kanbanObj.element.querySelectorAll("."+et+":not(."+Oe+")")).filter((function(e){return n.getColumnKey(e)===n.getColumnKey(S)}));w.length>0&&((0,t.addClass)(w,"e-multi-active"),w[0].previousElementSibling&&(0,t.addClass)([w[0].previousElementSibling],"e-multi-bottom-border"))}document.body.style.cursor=c&&c.classList.contains(Xe)||c&&o&&o.classList.contains(Xe)?"":"not-allowed",!r||(0,t.closest)(r,"."+de).classList.contains(Xe)||c&&o&&o.classList.contains(Xe)||(r.style.cursor="not-allowed",document.body.style.cursor="not-allowed"),this.isExternalDrop&&"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.multiCloneRemove()),this.updateScrollPosition();var E={data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.kanbanObj.trigger(f,E),this.parent.isExternalKanbanDrop=!1,this.isExternalDrop=!1}},e.prototype.removeElement=function(e,n){(n=n||this.parent).element.getElementsByClassName(e.className).length>0&&(0,t.remove)(e)},e.prototype.isTargetElementVisible=function(e){var n=(0,t.closest)(e,"."+be);if(!(0,t.isNullOrUndefined)(n)){var r=n.getBoundingClientRect().bottom;return!(e.getBoundingClientRect().bottom>r)}return!0},e.prototype.externalDrop=function(e){var n=this;this.parent.externalDropId.forEach((function(r){var a=(0,t.closest)(e,r);if(a)if(a.classList.contains("e-kanban")){n.parent.externalDropObj=document.querySelector(r).ej2_instances[0],n.parent.isExternalKanbanDrop=!0;var i="."+ge+":not(."+me+"):not(."+Be+") ."+de,o=[].slice.call(n.parent.externalDropObj.element.querySelectorAll(i));(0,t.addClass)(o,Xe)}else n.isExternalDrop=!0}))},e.prototype.multiCloneCreate=function(e,n){var r=n.offsetHeight,a=n.querySelector("."+dt);a&&(r-=a.offsetHeight),this.dragObj.targetCloneMulti.style.height=(0,t.formatUnit)(r),n.querySelector("."+ft)&&(0,t.addClass)([n.querySelector("."+ft)],Ze),(0,t.addClass)([n.querySelector("."+be)],Ze),n.querySelector("."+be).style.height="auto",n.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var i=0,o=e;i<o.length;i++){var l=o[i],s=(0,t.closest)(this.dragObj.draggedClone,"."+de),d=this.kanbanObj.columns[s.cellIndex].transitionColumns,c=this.allowedTransition(this.dragObj.element.getAttribute("data-key"),l,d),p=c?"":" "+Oe,h=(0,t.createElement)("div",{className:et+p,attrs:{"data-key":l.trim()}}),u=(0,t.createElement)("div",{className:"e-text",innerHTML:l.trim()});n.appendChild(this.dragObj.targetCloneMulti).appendChild(h).appendChild(u),h.style.cursor=c?"":"not-allowed",h.style.lineHeight=h.style.height=(0,t.formatUnit)(r/e.length),u.style.top=(0,t.formatUnit)(r/2-u.offsetHeight/2)}},e.prototype.allowedTransition=function(e,t,n){for(var r=!0,a=t.split(","),i=0;i<a.length;i++){if(e===a[i].trim())return!0;if(n){if(1===n.length&&0===n[0].length)return!0;for(var o=0;o<n.length;o++){if(a[i].trim()===n[o].trim())return!0;r=!1}}}return r},e.prototype.cellDropping=function(){var e=this,n=(0,t.closest)(this.dragObj.draggedClone,"."+de),r=(0,t.closest)(this.dragObj.draggedClone,"."+ge);if(n&&n.classList.contains(ke)&&(0,t.addClass)([n],Xe),this.addDropping(r,n),this.kanbanObj.swimlaneSettings.keyField&&this.kanbanObj.swimlaneSettings.allowDragAndDrop){var a="."+ge+":not(."+me+"):not(."+Be+")",i=[].slice.call(this.kanbanObj.element.querySelectorAll(a));[].slice.call(i).forEach((function(t){r!==t&&e.addDropping(t,n)}))}},e.prototype.addDropping=function(e,n){var r=this;if(n&&this.borderElm&&0!==this.borderElm.length){n.classList.contains(Xe)&&(0,t.removeClass)([n],Xe);var a=n.getBoundingClientRect();this.updateDimension(a)}else n&&e&&[].slice.call(e.children).forEach((function(e){var a=r.kanbanObj.columns[n.cellIndex].transitionColumns;e!==n&&e.classList.contains(ke)&&r.allowedTransition(n.getAttribute("data-key"),e.getAttribute("data-key"),a)&&(0,t.addClass)([e],Xe)}))},e.prototype.updateDimension=function(e,n){[].slice.call(this.borderElm).forEach((function(r){!r.parentElement||"true"!==r.parentElement.getAttribute("aria-expanded")&&r.parentElement.hasAttribute("aria-expanded")||(0,t.addClass)([r],Xe);var a=r.previousElementSibling;r.style.height=parseInt(e.height.toString(),10)-(a&&a.classList.contains(ft)?a.offsetHeight+a.offsetTop:0)+"px",n&&"TABLE"===n.tagName||(r.style.width=parseInt(e.width.toString(),10)+"px"),r.style.left=r.parentElement.getBoundingClientRect().left-(0,t.closest)(r,".e-kanban").getBoundingClientRect().left+"px"}))},e.prototype.keydownHandler=function(e){"Escape"===e.code&&this.dragObj.cloneElement&&(t.EventHandler.remove(this.dragObj.cloneElement,"keydown",this.keydownHandler),this.dragObj.element.removeAttribute("aria-grabbed"),this.dragStopClear(),this.dragStopPostClear())},e.prototype.dragStop=function(e){var n,r,a,i,o,l=this,s=(0,t.closest)(this.dragObj.targetClone,"."+de);if(this.parent.enableVirtualization&&!(0,t.isNullOrUndefined)(s)&&s.classList.add("e-dropped-column"),t.EventHandler.remove(document.body,"keydown",this.keydownHandler),[].slice.call(this.borderElm).forEach((function(e){e.classList.remove(Xe)})),this.dragObj.targetClone.parentElement){var d=(i=this.dragObj.selectedCards&&this.dragObj.selectedCards.length>1&&"Index"===this.parent.sortSettings.sortBy)?"."+Ce+":not(."+We+"),."+Qe:"."+Ce+":not(."+Ye+", ."+We+"),."+Qe;r=[].slice.call(this.dragObj.targetClone.parentElement.querySelectorAll(d)).indexOf(this.dragObj.targetClone),this.parent.enableVirtualization&&!(0,t.isNullOrUndefined)(this.dragObj.targetClone.nextElementSibling)&&(a=this.dragObj.targetClone.nextElementSibling.getAttribute("data-id"))}(!(0,t.isNullOrUndefined)(this.kanbanObj)&&this.kanbanObj.element.querySelector("."+$e)&&(n=(0,t.closest)(e.target,"."+et+":not(."+Oe+")")),s||n)&&(s?o=this.getColumnKey(s):(o=this.getColumnKey(n),s=(0,t.closest)(n,"."+de)),this.dragObj.selectedCards instanceof HTMLElement?this.updateDroppedData(this.dragObj.selectedCards,o,s):this.dragObj.selectedCards.forEach((function(e){l.updateDroppedData(e,o,s)})),this.parent.sortSettings.field&&"Index"===this.parent.sortSettings.sortBy&&this.changeOrder(this.dragObj.modifiedData,e.helper));0===this.dragObj.modifiedData.length&&(this.dragObj.modifiedData=this.dragObj.cardDetails);var c={cancel:!1,data:this.dragObj.modifiedData,event:e,element:this.dragObj.selectedCards,dropIndex:r};this.parent.trigger(y,c,(function(e){if(l.dragStopClear(),!e.cancel&&(s||n)){var t=e.data instanceof Array&&e.data.length>1?e.data:e.data[0],r=void 0,o=void 0;l.parent.enableVirtualization&&(r=s.closest(".e-kanban").querySelector(".e-dragged-column").getAttribute("data-key"),o=s.getAttribute("data-key")),l.parent.crudModule.updateCard(t,e.dropIndex,!0,a,r,o,i),l.parent.enableVirtualization&&(l.parent.virtualLayoutModule.refreshColumnData(r,o),l.parent.virtualLayoutModule.ensureColumnNotEmpty(r))}l.removeEmptyTrElement(),l.dragStopPostClear()}))},e.prototype.removeEmptyTrElement=function(){if(!this.parent.swimlaneSettings.showEmptyRow)for(var e=this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row"),n=0;n<e.length;n++){var r=e[n].nextElementSibling.querySelectorAll(".e-card-wrapper .e-card");(0,t.isNullOrUndefined)(e[n].nextElementSibling)||0!==r.length||((0,t.detach)(e[n].nextElementSibling),(0,t.detach)(e[n]))}},e.prototype.dragStopClear=function(){this.removeElement(this.dragObj.draggedClone),this.removeElement(this.dragObj.targetClone,this.kanbanObj),this.removeElement(this.dragObj.cloneElement),[].slice.call(this.parent.element.querySelectorAll("."+Ke)).forEach((function(e){(0,t.remove)(e)})),this.dragObj.element.style.removeProperty("width"),this.multiCloneRemove(),this.dragObj.selectedCards instanceof HTMLElement?(0,t.removeClass)([this.dragObj.selectedCards],Ye):(0,t.removeClass)(this.dragObj.selectedCards,Ye),clearInterval(this.dragObj.navigationInterval),this.dragObj.navigationInterval=null,"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),[].slice.call(this.parent.element.querySelectorAll("."+Ce+"[style]")).forEach((function(e){e.style.cursor=""}));var e="."+ge+":not(."+me+")";([].slice.call(this.parent.element.querySelectorAll(e+" ."+de)).forEach((function(e){return(0,t.removeClass)([e],Xe)})),this.parent.externalDropObj)&&[].slice.call(this.parent.externalDropObj.element.querySelectorAll(e+" ."+de)).forEach((function(e){return(0,t.removeClass)([e],Xe)}))},e.prototype.dragStopPostClear=function(){this.parent.isAdaptive&&(this.parent.touchModule.tabHold=!1),this.parent.element.querySelector(".e-dragged-column")&&this.parent.element.querySelector(".e-dragged-column").classList.remove("e-dragged-column"),this.parent.element.querySelector(".e-dropped-column")&&this.parent.element.querySelector(".e-dropped-column").classList.remove("e-dropped-column"),this.dragObj.cardDetails=this.dragObj.modifiedData=[],this.isDragging=!1,this.parent.isExternalKanbanDrop=!1,this.parent.externalDropObj=null},e.prototype.updateDroppedData=function(e,n,r){var a=this.parent.getCardDetails(e),i=(0,t.extend)({},a,null,!0);if(1===n.split(",").length&&(i[this.parent.keyField]=n),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){var o=(0,t.closest)(r,"."+ge).previousElementSibling;if(this.parent.isAdaptive){var l=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField;i[this.parent.swimlaneSettings.keyField]=l}else i[this.parent.swimlaneSettings.keyField]=this.getColumnKey(o)}this.dragObj.modifiedData.push(i)},e.prototype.changeOrder=function(e,t){var n,r=this,a=!1;if(!(n="Ascending"===this.kanbanObj.sortSettings.direction?t===this.dragObj.targetClone.previousElementSibling&&this.dragObj.targetClone.previousElementSibling&&this.dragObj.targetClone.previousElementSibling.previousElementSibling?this.dragObj.targetClone.previousElementSibling.previousElementSibling:this.dragObj.targetClone.previousElementSibling:this.dragObj.targetClone.nextElementSibling)||n.classList.contains(Ye)||n.classList.contains(We)||n.classList.contains(Ke))if(this.dragObj.targetClone.nextElementSibling&&"Ascending"===this.kanbanObj.sortSettings.direction)n=this.dragObj.targetClone.nextElementSibling;else{if(!this.dragObj.targetClone.previousElementSibling||"Descending"!==this.kanbanObj.sortSettings.direction)return;n=this.dragObj.targetClone.previousElementSibling}else a=!0;if(n.classList.contains(Ce)){var i=this.kanbanObj.getCardDetails(n)[this.kanbanObj.sortSettings.field];e.length>1&&"Descending"===this.kanbanObj.sortSettings.direction&&(e=e.reverse()),e.forEach((function(e,t){a?e[r.kanbanObj.sortSettings.field]=++i:1!==i&&t<=e[r.kanbanObj.sortSettings.field]?e[r.kanbanObj.sortSettings.field]=--i:1===i&&(e[r.kanbanObj.sortSettings.field]=t+1)}))}},e.prototype.toggleVisible=function(e,n){var r=this,a="."+ne+":not(."+se+")";[].slice.call(this.kanbanObj.element.querySelectorAll(a)).forEach((function(t){r.getColumnKey(t)===r.getColumnKey(n||e)&&r.kanbanObj.actionModule.columnToggle(t)}));var i=(0,t.closest)(this.dragObj.draggedClone,"."+de);if(i){var o=(0,t.formatUnit)(i.offsetWidth-k);this.dragObj.draggedClone.style.width=o,this.dragObj.cloneElement.style.width=o}},e.prototype.multiCloneRemove=function(){var e=(0,t.isNullOrUndefined)(this.kanbanObj)?[]:[].slice.call(this.kanbanObj.element.querySelectorAll("."+$e));e.length>0&&([].slice.call(this.kanbanObj.element.querySelectorAll("."+et)).forEach((function(e){return(0,t.remove)(e)})),e.forEach((function(e){var n=(0,t.closest)(e,"."+de);n&&(n.style.borderStyle="",n.querySelector("."+ft)&&(0,t.removeClass)([n.querySelector("."+ft)],Ze),(0,t.removeClass)([n.querySelector("."+be)],Ze))})),this.removeElement(this.dragObj.targetCloneMulti,this.kanbanObj))},e.prototype.calculateArgs=function(e){var t=this.getPageCoordinates(e);this.dragObj.pageY=t.pageY,this.dragObj.pageX=t.pageX,this.isDragging=!0,this.kanbanObj.isAdaptive&&this.kanbanObj.tooltipModule&&this.kanbanObj.tooltipModule.tooltipObj.close()},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getColumnKey=function(e){return e&&e.getAttribute("data-key")?e.getAttribute("data-key").trim():""},e.prototype.updateScrollPosition=function(){var e=this;(0,t.isNullOrUndefined)(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval((function(){e.autoScroll()}),100))},e.prototype.autoScrollValidation=function(){var e=this.dragObj.pageY,t=this.dragObj.pageX,n={left:!1,right:!1,top:!1,bottom:!1},r=this.kanbanObj.element.querySelector("."+ce).getBoundingClientRect();e<r.top+30+window.pageYOffset&&e>r.top+window.pageYOffset&&(n.top=!0),e>r.bottom-30+window.pageYOffset&&e<r.bottom+window.pageYOffset&&(n.bottom=!0),t<r.left+30+window.pageXOffset&&t>r.left+window.pageXOffset&&(n.left=!0),t>r.right-30+window.pageXOffset&&t<r.right+window.pageXOffset&&(n.right=!0),this.dragEdges=n},e.prototype.autoScroll=function(){this.autoScrollValidation();var e=30;if(this.kanbanObj.isAdaptive){var n;if(this.dragEdges.top||this.dragEdges.bottom?n=this.dragObj.targetClone?(0,t.closest)(this.dragObj.targetClone,"."+be):(0,t.closest)(this.dragObj.draggedClone,"."+be):(this.dragEdges.right||this.dragEdges.left)&&(n=this.kanbanObj.element.querySelector("."+ce)),n){var r=n.offsetHeight<=n.scrollHeight,a=n.offsetWidth<=n.scrollWidth,i=n.scrollTop>=0&&n.scrollTop+n.offsetHeight<=n.scrollHeight,o=n.scrollLeft>=0&&n.scrollLeft+n.offsetWidth<=n.scrollWidth;if(r&&i&&(this.dragEdges.top||this.dragEdges.bottom)&&(n.scrollTop+=this.dragEdges.top?-66:e),a&&o&&(this.dragEdges.left||this.dragEdges.right))((this.parent.enableVirtualization?this.kanbanObj.virtualLayoutModule.getWidth():this.kanbanObj.layoutModule.getWidth())*(this.kanbanObj.columns.length-1)>n.scrollLeft||this.dragEdges.left)&&(n.scrollLeft+=this.dragEdges.left?-30:e)}}else{var l=this.kanbanObj.element.querySelector("."+ce),s=this.dragObj.targetClone.parentElement,d=l.offsetHeight<=l.scrollHeight,c=l.offsetWidth<=l.scrollWidth,p=d&&l.scrollTop>=0&&l.scrollTop+l.offsetHeight<=l.scrollHeight,h=c&&l.scrollLeft>=0&&l.scrollLeft+l.offsetWidth<=l.scrollWidth;p&&(this.dragEdges.top||this.dragEdges.bottom)&&(l.scrollTop+=this.dragEdges.top?-30:e,this.parent.swimlaneSettings.enableFrozenRows&&(this.dragObj.cloneElement.style.top=this.dragEdges.top?parseInt(this.dragObj.cloneElement.style.top,10)-e+"px":parseInt(this.dragObj.cloneElement.style.top,10)+e+"px"),s&&(s.scrollTop+=this.dragEdges.top?-30:e)),h&&(this.dragEdges.left||this.dragEdges.right)&&(l.scrollLeft+=this.dragEdges.left?-30:e,s&&(s.scrollLeft+=this.dragEdges.left?-30:e)),this.dragObj.pageY-window.scrollY<e?window.scrollTo(window.scrollX,window.scrollY-e):window.innerHeight-(this.dragObj.pageY-window.scrollY)<e&&window.scrollTo(window.scrollX,window.scrollY+e)}},e.prototype.unWireDragEvents=function(e){if(!(0,t.isNullOrUndefined)(e)&&!(0,t.isNullOrUndefined)(e.ej2_instances[0])){var n=e.ej2_instances[0];n&&!n.isDestroyed&&n.destroy()}},e}(),kt=d(778),Ot=d(323),xt=function(){function e(e){this.preventUpdate=!1,this.parent=e}return e.prototype.openDialog=function(e,t){this.action=e,this.parent.activeCardData.data=t,this.renderDialog(t,e),this.dialogObj.show()},e.prototype.closeDialog=function(){this.dialogObj.hide()},e.prototype.renderDialog=function(e,r){this.element=(0,t.createElement)("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);var a={buttons:this.getDialogButtons(r),content:this.getDialogContent(e,r),cssClass:Ue,enableRtl:this.parent.enableRtl,header:this.parent.localeObj.getConstant("Add"===r?"addTitle":"Edit"===r?"editTitle":"deleteTitle"),height:"auto",isModal:!0,showCloseIcon:!0,width:"Delete"===r?400:350,visible:!1,beforeOpen:this.onBeforeDialogOpen.bind(this),beforeClose:this.onBeforeDialogClose.bind(this)};this.dialogObj=new n.Dialog((0,t.extend)(a,"Delete"!==r&&this.parent.dialogSettings.model||{}),this.element),"Delete"!==r&&this.applyFormValidation(),this.dialogObj.element.querySelector(".e-dlg-closeicon-btn").title=this.parent.localeObj.getConstant("close")},e.prototype.getDialogContent=function(e,n){if("Delete"===n)return this.parent.localeObj.getConstant("deleteContent");var r=(0,t.createElement)("div",{className:"e-kanban-form-wrapper"}),a=(0,t.createElement)("form",{id:this.parent.element.id+"EditForm",className:ze,attrs:{onsubmit:"return false;"}});if(this.parent.dialogSettings.template){e&&(this.destroyComponents(),[].slice.call(a.childNodes).forEach((function(e){return(0,t.remove)(e)})));var i=this.parent.element.id+"_dialogTemplate",o=this.parent.templateParser(this.parent.dialogSettings.template)(e,this.parent,"dialogTemplate",i,!1);(0,t.append)(o,a),this.parent.renderTemplates()}else{var l=(0,t.createElement)("div",{className:"e-kanban-dialog-content"});a.appendChild(l);var s=(0,t.createElement)("table");l.appendChild(s);for(var d=0,c=this.getDialogFields();d<c.length;d++){var p=c[d],h=(0,t.createElement)("tr");s.appendChild(h),h.appendChild((0,t.createElement)("td",{className:"e-label",innerHTML:p.text?p.text:p.key}));var u=(0,t.createElement)("td");h.appendChild(u),u.appendChild(this.renderComponents(p))}}return r.appendChild(a),r},e.prototype.getDialogFields=function(){var e=this.parent.dialogSettings.fields;return 0===e.length&&(e=[{text:"ID",key:this.parent.cardSettings.headerField,type:"TextBox"},{key:this.parent.keyField,type:"DropDown"},{key:this.parent.cardSettings.contentField,type:"TextArea"}],this.parent.sortSettings.field&&e.splice(e.length-1,0,{key:this.parent.sortSettings.field,type:"TextBox"}),this.parent.swimlaneSettings.keyField&&e.splice(e.length-1,0,{key:this.parent.swimlaneSettings.keyField,type:"DropDown"})),e},e.prototype.getDialogButtons=function(e){var t="Delete"===e?"e-dialog-no":"e-dialog-cancel",n=[{buttonModel:{cssClass:"e-flat "+("Delete"===e?"e-dialog-yes":"Add"===e?"e-dialog-add":"e-dialog-edit"),isPrimary:!0,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"save":"yes")},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-flat "+t,isPrimary:!1,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"cancel":"no")},click:this.dialogButtonClick.bind(this)}];if("Edit"===e){var r={buttonModel:{cssClass:"e-flat e-dialog-delete",isPrimary:!1,content:this.parent.localeObj.getConstant("delete")},click:this.dialogButtonClick.bind(this)};n.splice(0,0,r)}return n},e.prototype.renderComponents=function(e){var n,r,a,i=(0,t.createElement)("div",{className:e.key+"_wrapper"}),o=(0,t.createElement)("input",{className:_e,attrs:{name:e.key}});i.appendChild(o);var l=this.parent.activeCardData.data?this.parent.activeCardData.data[e.key]:null;switch(e.type){case"DropDown":if(e.key===this.parent.keyField){var s=this.parent.enableVirtualization?this.parent.virtualLayoutModule.columnKeys:this.parent.layoutModule.columnKeys;if(this.parent.actionModule.hideColumnKeys.length>0){s=[];for(var d=0;d<this.parent.columns.length;d++){if(this.parent.enableVirtualization?this.parent.virtualLayoutModule.isColumnVisible(this.parent.columns[d]):this.parent.layoutModule.isColumnVisible(this.parent.columns[d]))s="number"==typeof this.parent.columns[d].keyField?s.concat(this.parent.columns[d].keyField.toString()):s.concat(this.parent.columns[d].keyField.split(",").map((function(e){return e.trim()})))}}r={dataSource:s,value:l?l.toString():l}}else e.key===this.parent.swimlaneSettings.keyField&&(r={dataSource:[].slice.call(this.parent.enableVirtualization?this.parent.virtualLayoutModule.kanbanRows:this.parent.layoutModule.kanbanRows),fields:{text:"textField",value:"keyField"},value:l});a=new kt.DropDownList(r);break;case"Numeric":a=new Ot.NumericTextBox({value:l});break;case"TextBox":a=new Ot.TextBox({value:l}),l&&this.parent.cardSettings.headerField===e.key&&(a.enabled=!1);break;case"TextArea":(0,t.remove)(o),n=(0,t.createElement)("div"),o=(0,t.createElement)("textarea",{className:_e,attrs:{name:e.key,rows:"3","aria-label":this.parent.cardSettings.contentField},innerHTML:l}),i.appendChild(n).appendChild(o)}return a&&a.appendTo(o),i},e.prototype.onBeforeDialogOpen=function(e){var t=this,n={data:this.parent.activeCardData.data,cancel:!1,element:this.element,target:this.parent.activeCardData.element,requestType:this.action};this.storeElement=document.activeElement,parseInt(e.maxHeight,10)<=250&&(e.maxHeight="250px"),this.parent.trigger(b,n,(function(n){e.cancel=n.cancel,n.cancel&&t.destroy()}))},e.prototype.onBeforeDialogClose=function(e){var n=this,r=this.getFormElements(),a={};if(e.isInteracted&&(this.preventUpdate=!0),!this.preventUpdate)for(var i=0,o=r;i<o.length;i++){var l=o[i],s=l.name||this.getColumnName(l);if(!(0,t.isNullOrUndefined)(s)&&""!==s){var d=this.getValueFromElement(l);s===this.parent.cardSettings.headerField&&(d="string"===this.getIDType()?d:parseInt(d,10)),a[s]=d}}this.preventUpdate=!1;var c={data:a=(0,t.extend)(this.parent.activeCardData.data,a),cancel:!1,element:this.element,requestType:this.action};this.parent.trigger(S,c,(function(t){e.cancel=t.cancel,t.cancel||(n.cardData=c.data,n.destroy(),n.parent.actionModule.SingleCardSelection(n.cardData))}))},e.prototype.getIDType=function(){return 0!==this.parent.kanbanData.length?typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]:"string"},e.prototype.applyFormValidation=function(){for(var e=this,t=this.element.querySelector("."+ze),n={},r=0,a=this.parent.dialogSettings.fields;r<a.length;r++){var i=a[r];n[i.key]=i.validationRules&&Object.keys(i.validationRules).length>0?i.validationRules:null}this.formObj=new Ot.FormValidator(t,{rules:n,customPlacement:function(t,n){var r=n.getAttribute("for");e.element.querySelector("#"+r+"_Error")||e.createTooltip(t,n,r,"")},validationComplete:function(t){var n=e.element.querySelector("#"+t.inputName+"_Error");n&&(n.style.display="failure"===t.status?"":"none")}})},e.prototype.createTooltip=function(e,n,r,a){var i,o,l=e.parentElement.getBoundingClientRect();this.element.classList.contains(Ue)?(i=this.element,o=this.element.getBoundingClientRect()):o=(i=this.element.querySelector(".e-kanban-dialog .e-dlg-content")).getBoundingClientRect();var s=(0,t.createElement)("div",{className:"e-tooltip-wrap e-popup "+Ve,id:r+"_Error",styles:"display:"+a+";top:"+(l.bottom-o.top+i.scrollTop+9)+"px;left:"+(l.left-o.left+i.scrollLeft+l.width/2)+"px;"}),d=(0,t.createElement)("div",{className:"e-tip-content"});d.appendChild(n);var c=(0,t.createElement)("div",{className:"e-arrow-tip e-tip-top"});c.appendChild((0,t.createElement)("div",{className:"e-arrow-tip-outer e-tip-top"})),c.appendChild((0,t.createElement)("div",{className:"e-arrow-tip-inner e-tip-top"})),s.appendChild(d),s.appendChild(c),i.appendChild(s),s.style.left=parseInt(s.style.left,10)-s.offsetWidth/2+"px"},e.prototype.destroyToolTip=function(){this.element&&this.element.querySelectorAll("."+Ve).forEach((function(e){return(0,t.remove)(e)})),this.formObj&&this.formObj.element&&this.formObj.reset()},e.prototype.dialogButtonClick=function(e){var n=e.target.cloneNode(!0);(0,t.isNullOrUndefined)(e.keyCode)||13!==e.keyCode||(n=this.dialogObj.element.querySelector(".e-footer-content button.e-primary").cloneNode(!0));var r=this.formObj.element.id;if(document.getElementById(r)&&this.formObj.validate()&&(n.classList.contains("e-dialog-edit")||n.classList.contains("e-dialog-add"))&&(this.dialogObj.hide(),!(0,t.isNullOrUndefined)(this.cardData))){if(n.classList.contains("e-dialog-edit")){var a=this.parent.activeCardData,i=void 0;a.data[this.parent.keyField]===this.cardData[this.parent.keyField]&&a.element&&(i=[].slice.call(a.element.parentElement.children).indexOf(a.element)),this.parent.enableHtmlSanitizer&&"string"==typeof this.cardData[this.parent.cardSettings.contentField]&&(this.cardData[this.parent.cardSettings.contentField]=t.SanitizeHtmlHelper.sanitize(this.cardData[this.parent.cardSettings.contentField])),this.parent.crudModule.updateCard(this.cardData,i)}n.classList.contains("e-dialog-add")&&this.parent.crudModule.addCard(this.cardData),this.parent.actionModule.SingleCardSelection(this.cardData),this.cardData=null}n.classList.contains("e-dialog-edit")||n.classList.contains("e-dialog-add")||(n.classList.contains("e-dialog-cancel")&&(this.preventUpdate=!0),this.dialogObj.hide(),n.classList.contains("e-dialog-yes")?this.parent.crudModule.deleteCard(this.parent.activeCardData.data):n.classList.contains("e-dialog-no")?this.openDialog("Edit",this.parent.activeCardData.data):n.classList.contains("e-dialog-delete")&&this.openDialog("Delete",this.parent.activeCardData.data))},e.prototype.getFormElements=function(){for(var e=[],t=0,n=[].slice.call(this.element.querySelectorAll("."+_e));t<n.length;t++){var r=n[t];r.classList.contains("e-control")?e.push(r):r.querySelector(".e-control")?e.push(r.querySelector(".e-control")):e.push(r)}return e},e.prototype.getColumnName=function(e){var n=e.getAttribute("data-name")||"";if(""===n){var r=!1,a="";e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?(a=e.classList.contains("e-dropdownlist")?"e-ddl":"e-multiselect",r=!0):e.classList.contains("e-numerictextbox")&&(a="e-numeric");var i=r?"."+a+":not(.e-control)":"."+a,o=(0,t.closest)(e,i)||e.querySelector("."+a);if(o){var l=o.querySelector("[name]");l&&(n=l.name)}}return n},e.prototype.getValueFromElement=function(e){return e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?e.ej2_instances[0].value:e.classList.contains("e-checkbox")?e.ej2_instances[0].checked:"checkbox"===e.type?e.checked:e.value},e.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements();e<t.length;e++){var n=t[e].ej2_instances;n&&n.length>0&&n.forEach((function(e){return e.destroy()})),this.parent.isReact&&this.formObj&&this.formObj.element.remove()}},e.prototype.destroy=function(){this.destroyToolTip(),this.destroyComponents(),this.dialogObj&&(this.dialogObj.destroy(),this.storeElement.focus(),this.dialogObj=null,(0,t.remove)(this.element),this.element=null)},e}(),Dt=function(){function e(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",multiSelectionEnter:"ctrl+13",multiSelectionSpace:"ctrl+32",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",shiftTab:"shift+tab",enter:"13",tab:"tab",delete:"46",escape:"27",space:"32"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.multiSelection=!1}return e.prototype.keyActionHandler=function(e){var n=this,r=this.parent.element.querySelectorAll("."+Ce+"."+tt).item(0);if(r||(0,t.closest)(document.activeElement,"."+Y)){var a,i=[];switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":e.preventDefault(),this.processUpDownArrow(e.action,r);break;case"rightArrow":case"leftArrow":this.processLeftRightArrow(e);break;case"firstCardSelection":case"lastCardSelection":this.processCardSelection(e.action,r);break;case"multiSelectionEnter":case"multiSelectionSpace":document.activeElement&&this.parent.actionModule.cardSelection(document.activeElement,!0,!1);break;case"space":case"enter":this.processEnter(e,r);break;case"escape":if(document.activeElement.classList.contains(Ce)||document.activeElement.classList.contains(ft))if(document.activeElement.classList.contains(tt))(0,t.removeClass)([document.activeElement],tt),document.activeElement.focus();else{var o=(0,t.closest)(document.activeElement,"."+de),l=[].slice.call(o.querySelectorAll("."+Ce));(0,t.removeClass)(l,tt),o.focus(),this.cardTabIndexRemove(),this.addRemoveTabIndex("Add")}break;case"tab":case"shiftTab":a=(0,t.closest)(document.activeElement,"."+de),document.activeElement.classList.contains(Ce)&&(document.activeElement.nextElementSibling||"tab"!==e.action||e.preventDefault(),!document.activeElement.previousElementSibling&&a.querySelector("."+ft)&&"tab"===e.action&&(0,t.addClass)([a.querySelector("."+ft)],vt)),document.activeElement.classList.contains(ft)&&(!a.querySelector("."+Ce)&&"tab"===e.action||"shiftTab"===e.action)&&e.preventDefault(),document.activeElement.classList.contains(Y)&&(this.cardTabIndexRemove(),this.parent.keyboardModule.addRemoveTabIndex("Add"));break;case"delete":[].slice.call(this.parent.element.querySelectorAll("."+Ce+"."+tt)).forEach((function(e){i.push(n.parent.getCardDetails(e))})),this.parent.crudModule.deleteCard(i)}}},e.prototype.processCardSelection=function(e,n){if(n){(0,t.removeClass)([n],tt),this.parent.enableVirtualization?this.parent.virtualLayoutModule.disableAttributeSelection(n):this.parent.layoutModule.disableAttributeSelection(n);var r=this.parent.actionModule.selectionArray;r.splice(r.indexOf(n.getAttribute("data-id")),1)}this.cardTabIndexRemove();var a=[].slice.call(this.parent.element.querySelectorAll("."+Ce)),i="firstCardSelection"===e?a[0]:a[a.length-1];this.parent.actionModule.cardSelection(i,!1,!1),this.addRemoveTabIndex("Remove"),i.focus(),[].slice.call((0,t.closest)(i,"."+de).querySelectorAll("."+Ce)).forEach((function(e){e.setAttribute("tabindex","0")}))},e.prototype.processLeftRightArrow=function(e){document.activeElement.classList.contains(de)&&("rightArrow"===e.action&&document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():"leftArrow"===e.action&&document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus())},e.prototype.processUpDownArrow=function(e,n){if("upArrow"===e&&document.activeElement){if(document.activeElement.classList.contains(Ce)&&document.activeElement.previousElementSibling)document.activeElement.previousElementSibling.focus();else if(document.activeElement.classList.contains(ft)){document.activeElement.setAttribute("tabindex","-1"),(0,t.removeClass)([document.activeElement],vt);var r=(0,t.closest)(document.activeElement,"."+de);r.querySelectorAll("."+Ce).length>0&&[].slice.call(r.querySelectorAll("."+Ce)).slice(-1)[0].focus()}this.removeSelection()}else if("downArrow"===e&&document.activeElement&&document.activeElement.classList.contains(Ce)){if(document.activeElement.nextElementSibling)document.activeElement.nextElementSibling.focus();else if((0,t.closest)(document.activeElement,"."+be).nextElementSibling){var a=(0,t.closest)(document.activeElement,"."+be).nextElementSibling;a.setAttribute("tabindex","0"),(0,t.addClass)([a],vt),a.focus()}this.removeSelection()}if(("multiSelectionByUpArrow"===e||"multiSelectionByDownArrow"===e)&&n&&"Multiple"===this.parent.cardSettings.selectionType){var i=void 0;(i="multiSelectionByUpArrow"===e?document.activeElement.previousElementSibling:document.activeElement.nextElementSibling)&&(this.parent.actionModule.cardSelection(i,!1,!0),i.focus(),this.multiSelection=!0)}},e.prototype.removeSelection=function(){if(this.multiSelection){var e=this.parent.getSelectedCards();e.length>0&&((0,t.removeClass)(e,tt),this.parent.enableVirtualization?this.parent.virtualLayoutModule.disableAttributeSelection(e):this.parent.layoutModule.disableAttributeSelection(e)),this.multiSelection=!1}},e.prototype.cardTabIndexRemove=function(){[].slice.call(this.parent.element.querySelectorAll("."+Ce)).forEach((function(e){e.setAttribute("tabindex","-1")})),[].slice.call(this.parent.element.querySelectorAll("."+ft)).forEach((function(e){e.setAttribute("tabindex","-1"),(0,t.removeClass)([e],vt)}))},e.prototype.processEnter=function(e,t){"space"===e.action&&e.preventDefault();var n=e.target;if(n.classList.contains(oe)&&this.parent.actionModule.columnExpandCollapse(e),(n.classList.contains(fe)||n.classList.contains(ye))&&this.parent.actionModule.rowExpandCollapse(e),document.activeElement.classList.contains(Ce)&&this.parent.actionModule.cardSelection(document.activeElement,!1,!1),document.activeElement.classList.contains(ft)&&(this.parent.dialogModule.dialogObj||this.parent.actionModule.addButtonClick(document.activeElement),document.activeElement.focus()),n.classList.contains(de)){var r=[].slice.call(n.querySelectorAll("."+Ce));this.addRemoveTabIndex("Remove"),r.length>0&&(n.querySelector("."+Ce).focus(),r.forEach((function(e){e.setAttribute("tabindex","0")}))),n.querySelector("."+ft)&&(n.querySelector("."+ft).setAttribute("tabindex","0"),n.querySelector("."+ft).focus())}t===document.activeElement&&1===this.parent.element.querySelectorAll("."+tt).length&&(this.parent.activeCardData={data:this.parent.getCardDetails(t),element:t},this.parent.dialogModule.dialogObj||this.parent.dialogModule.openDialog("Edit",this.parent.getCardDetails(t)),t.focus())},e.prototype.addRemoveTabIndex=function(e){var t="Add"===e?"0":"-1",n=[].slice.call(this.parent.element.querySelectorAll("."+oe));n.length>0&&n.forEach((function(e){e.setAttribute("tabindex",t)}));var r=[].slice.call(this.parent.element.querySelectorAll("."+fe));r.length>0&&r.forEach((function(e){e.setAttribute("tabindex",t)}));var a="."+ge+":not(."+me+") ."+de;[].slice.call(this.parent.element.querySelectorAll(a)).forEach((function(e){e.setAttribute("tabindex",t)}))},e.prototype.destroy=function(){this.keyboardModule.destroy()},e}(),At=function(){function e(e){this.parent=e,this.renderTooltip()}return e.prototype.renderTooltip=function(){this.tooltipObj=new n.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:"."+nt,beforeRender:this.onBeforeRender.bind(this),beforeClose:this.onBeforeClose.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},e.prototype.onBeforeRender=function(e){if(this.parent.dragAndDropModule.isDragging)e.cancel=!0;else{var n;if(this.parent.tooltipTemplate){n=(0,t.createElement)("div");var r=(0,t.closest)(e.target,"."+Ce),a=this.parent.getCardDetails(r),i=this.parent.element.id+"_tooltipTemplate",o=this.parent.templateParser(this.parent.tooltipTemplate)(a,this.parent,"tooltipTemplate",i,!1);(0,t.append)(o,n),this.parent.renderTemplates()}else n=(0,t.initializeCSPTemplate)((function(){return'<div class="e-card-header-caption">'+e.target.innerText+"</div>"}));this.tooltipObj.setProperties({content:n},!0)}},e.prototype.onBeforeClose=function(){this.parent.resetTemplates(["tooltipTemplate"])},e.prototype.destroy=function(){this.tooltipObj.destroy(),(0,t.addClass)([this.parent.element],"e-control"),this.tooltipObj=null},e}(),Ft=d(741),Mt=function(){function e(e){this.parent=e,this.tabHold=!1}return e.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+ce),this.touchObj=new t.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},e.prototype.tapHoldHandler=function(e){this.tabHold=!0;var n=(0,t.closest)(e.originalEvent.target,"."+Ce);n&&"Multiple"===this.parent.cardSettings.selectionType&&(this.parent.actionModule.cardSelection(n,!0,!1),this.mobilePopup||(this.renderMobilePopup(),this.mobilePopup.show()),this.updatePopupContent())},e.prototype.renderMobilePopup=function(){if("Multiple"===this.parent.cardSettings.selectionType){var e=(0,t.createElement)("div",{className:"e-mobile-popup-wrapper e-popup-close",innerHTML:'<div class="e-popup-header"><button class="'+gt+'"></button></div><div class="'+mt+'"></div>'});document.body.appendChild(e),(0,t.addClass)([e],X),this.mobilePopup=new n.Popup(e,{targetType:"container",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut"},showAnimation:{name:"ZoomIn"},collision:{X:"fit",Y:"fit"},position:{X:"left",Y:"top"},viewPortElement:document.body,zIndex:1004,close:this.popupClose.bind(this)});var r=this.mobilePopup.element.querySelector("."+gt),a=new Ft.Button({cssClass:"e-flat e-round e-small",enableRtl:this.parent.enableRtl,iconCss:G+" e-close-icon"});a.appendTo(r),a.isStringTemplate=!0,t.EventHandler.add(r,"click",this.closeClick,this)}},e.prototype.getPopupContent=function(){var e,t=this.parent.getSelectedCards();return t.length>1?e="("+t.length+") "+this.parent.localeObj.getConstant("cardsSelected"):1===t.length&&(e=" "+this.parent.getCardDetails(t[0])[this.parent.cardSettings.headerField]),e},e.prototype.updatePopupContent=function(){if(this.mobilePopup){var e=this.getPopupContent();e?this.mobilePopup.element.querySelector("."+mt).textContent=e:this.mobilePopup.hide()}},e.prototype.closeClick=function(){this.parent.touchModule.mobilePopup.hide()},e.prototype.popupClose=function(){this.popupDestroy()},e.prototype.popupDestroy=function(){if(this.mobilePopup&&this.mobilePopup.element){var e=this.mobilePopup.element.querySelector(".e-control.e-btn").ej2_instances[0];e&&e.destroy(),this.mobilePopup.destroy(),(0,t.remove)(this.mobilePopup.element),this.mobilePopup=null}},e.prototype.unWireTouchEvents=function(){this.touchObj&&this.touchObj.destroy(),this.touchObj=null,this.element=null},e.prototype.destroy=function(){this.popupDestroy(),this.unWireTouchEvents(),this.tabHold=!1},e}(),Tt=d(215),jt=function(){function e(e){this.parent=e}return e.prototype.renderSwimlaneHeader=function(){var e=(0,t.createElement)("div",{className:rt,innerHTML:'<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons '+at+'"></div></div><div class="e-toolbar-level-title"><div class="'+it+'"></div></div></div>'});this.parent.element.appendChild(e),t.EventHandler.add(e.querySelector("."+at),"click",this.menuClick,this)},e.prototype.renderSwimlaneTree=function(){var e=this.parent.element.querySelector("."+rt).offsetHeight,r=window.innerHeight-e;this.popupOverlay=(0,t.createElement)("div",{className:ot,styles:"height: "+r+"px;"});var a=(0,t.createElement)("div",{className:lt,styles:"top:"+e+"px;"}),i=(0,t.createElement)("div",{className:st+" e-popup-close",styles:"height: "+r+"px;"});a.appendChild(i),a.appendChild(this.popupOverlay),this.parent.element.appendChild(a);var o=(0,t.createElement)("div",{className:"e-swimlane-tree"});i.appendChild(o);var l=this.parent.enableVirtualization?this.parent.virtualLayoutModule.kanbanRows:this.parent.layoutModule.kanbanRows;this.treeViewObj=new Tt.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:l,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this),drawNode:this.drawNode.bind(this)}),this.treeViewObj.appendTo(o);var s={targetType:"relative",actionOnScroll:"none",enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+ce)};s.content=this.treeViewObj.element,this.treePopup=new n.Popup(i,s)},e.prototype.menuClick=function(){if(this.parent.element.querySelector("."+st).classList.contains("e-popup-open"))this.treePopup.hide(),(0,t.removeClass)([this.popupOverlay],"e-enable");else{var e=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));(0,t.removeClass)(e,"e-active"),(0,t.addClass)([e[this.parent.layoutModule.swimlaneIndex]],"e-active"),this.treePopup.show(),(0,t.addClass)([this.popupOverlay],"e-enable")}},e.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(w,{processedData:this.parent.kanbanData}),e.event.preventDefault()},e.prototype.hidePopup=function(){this.treePopup.hide(),(0,t.removeClass)([this.popupOverlay],"e-enable")},e.prototype.getWidth=function(){return 80*window.innerWidth/100},e.prototype.drawNode=function(e){if(this.parent.swimlaneSettings.template&&this.parent.isReact){var n=this.parent.element.id+"_treeviewTemplate",r=this.parent.templateParser(this.parent.swimlaneSettings.template)(e.nodeData,this.parent,"nodeTemplate",n,!1);(0,t.append)(r,e.node.querySelector(".e-list-text"))}},e}(),qt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(e){function n(t){var n=e.call(this,t)||this;return n.kanbanRows=[],n.parent=t,n.columnKeys=[],n.swimlaneIndex=0,n.swimlaneData={},n.scrollLeft=0,n.frozenOrder=0,n.parent.on(w,n.initRender,n),n.parent.on(C,n.scrollUiUpdate,n),n}return qt(n,e),n.prototype.initRender=function(){if(0!==this.parent.columns.length){if(this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.swimlaneData=this.getSwimlaneCards(),this.parent.isAdaptive){var e=this.parent.element.querySelector("."+ce);e&&(this.scrollLeft=e.scrollLeft)}this.destroy(),this.parent.on(w,this.initRender,this),this.parent.on(C,this.scrollUiUpdate,this),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&0!==this.parent.kanbanData.length&&this.renderSwimlaneHeader();var n=(0,t.createElement)("div",{className:ee});this.parent.element.appendChild(n),this.renderHeader(n),this.renderContent(),this.renderCards(),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(C,{}),this.wireEvents(),this.parent.isInitialRender&&(this.parent.isInitialRender=!1)}},n.prototype.renderHeader=function(e){var n=(0,t.createElement)("div",{className:this.parent.swimlaneSettings.keyField?Z:""});e.appendChild(n);var r=(0,t.createElement)("table",{className:$+" "+te});n.appendChild(r),this.renderColGroup(r);var a=(0,t.createElement)("thead"),i=(0,t.createElement)("tbody",{className:"e-hide",innerHTML:"<tr><td></td></tr>",attrs:{role:"rowgroup"}});r.appendChild(i),r.appendChild(a),this.parent.stackedHeaders.length>0&&a.appendChild(this.createStackedRow(this.parent.stackedHeaders));var o=(0,t.createElement)("tr",{className:ue});a.appendChild(o);for(var l=function(e){if(s.isColumnVisible(e)){var n=s.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),r=(0,t.createElement)("th",{className:-1===n?ne:ne+" "+Be,attrs:{"data-role":"kanban-column","data-key":e.keyField.toString(),scope:"col"}}),a=[];e.allowToggle&&(a.push(he),e.isExpanded||a.push(Be)),(0,t.addClass)([r],a);var i=(0,t.createElement)("div",{className:re});r.appendChild(i),s.columnData=s.getColumnCards(s.parent.kanbanData);var l=s.columnData[e.keyField].length,d=(0,t.createElement)("div",{className:ae});if(i.appendChild(d),e.template){var c={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:l};(0,t.addClass)([r],J);var p=s.parent.element.id+"_columnTemplate",u=s.parent.templateParser(e.template)(c,s.parent,"columnTemplate",p,!1);(0,t.append)(u,d)}else{var g=(0,t.createElement)("div",{className:ie,innerHTML:e.headerText});if(d.appendChild(g),e.showItemCount){var m=(0,t.createElement)("div",{className:ve,innerHTML:"- "+l.toString()+" "+s.parent.localeObj.getConstant("items")});d.appendChild(m)}}if(e.allowToggle){var f=!(!e.isExpanded||-1!==n),y=f?Ne:He,v=(0,t.createElement)("div",{className:oe+" "+G+" "+y,attrs:{tabindex:"0",role:"button"}});v.setAttribute("aria-label",f?e.keyField+" Expand":e.keyField+" Collapse"),r.setAttribute("aria-expanded",f.toString()),i.appendChild(v)}var b={data:[{keyField:e.keyField,textField:e.headerText,count:l}],element:o,cancel:!1,requestType:"headerRow"};s.parent.trigger(h,b,(function(e){e.cancel||o.appendChild(r)}))}},s=this,d=0,c=this.parent.columns;d<c.length;d++){l(c[d])}},n.prototype.renderContent=function(){var e=(0,t.createElement)("div",{className:ce});this.parent.element.appendChild(e);var n=(0,t.createElement)("div",{className:this.parent.swimlaneSettings.keyField?Z:""});e.appendChild(n);var r=(0,t.createElement)("table",{className:$+" "+pe,attrs:{role:"presentation"}});n.appendChild(r),this.renderColGroup(r);for(var a=(0,t.createElement)("thead",{className:"e-hide",attrs:{role:"none"}}),i=0,o=this.parent.columns;i<o.length;i++){var l=o[i],s=(0,t.createElement)("th",{id:l.keyField,innerHTML:l.keyField,attrs:{scope:"col"}});s.style.display="none",a.appendChild(s)}r.appendChild(a);var d=(0,t.createElement)("tbody",{attrs:{role:"treegrid","aria-label":"Kanban Content"}});r.appendChild(d);var c=!1;this.swimlaneRow=this.kanbanRows,this.initializeSwimlaneTree();for(var p=0,h=this.swimlaneRow;p<h.length;p++){var u=h[p];if(this.parent.swimlaneSettings.keyField&&0!==this.parent.swimlaneToggleArray.length)c=-1!==this.parent.swimlaneToggleArray.indexOf(u.keyField);this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive&&this.renderSwimlaneRow(d,u,c),this.renderSingleContent(d,u,c)}},n.prototype.renderSingleContent=function(e,n,r){for(var a=r?ge+" "+Be:ge,i=(0,t.createElement)("tr",{className:a,attrs:{role:"row","aria-label":n.keyField+"row content"}}),o=0,l=this.parent.columns;o<l.length;o++){var s=l[o];if(this.isColumnVisible(s)){var d=this.parent.actionModule.columnToggleArray.indexOf(s.keyField.toString()),c=-1===d?de:de+" "+Be,p=(s.allowDrag?" "+Ee:"")+(s.allowDrop?" "+ke+" "+we:""),u=(0,t.createElement)("td",{className:c+p,attrs:{"data-role":"kanban-column","data-key":s.keyField.toString(),tabindex:"0","aria-describedby":s.keyField.toString(),role:"gridcell"}});if(s.allowToggle&&!s.isExpanded||-1!==d){(0,t.addClass)([u],Be);var g=(s.showItemCount?"["+this.getColumnData(s.keyField,this.swimlaneData[n.keyField]).length+"] ":"")+s.headerText;u.appendChild((0,t.createElement)("div",{className:Ie,innerHTML:g})),u.setAttribute("aria-expanded","false")}if(s.showAddButton){var m=(0,t.createElement)("div",{className:ft,attrs:{tabindex:"-1"}});m.appendChild((0,t.createElement)("div",{className:yt+" "+G})),u.appendChild(m)}i.appendChild(u)}}var f={data:[{keyField:n.keyField,textField:n.textField,count:n.count}],element:i,cancel:!1,requestType:"contentRow"};this.parent.trigger(h,f,(function(t){t.cancel||(e.classList.contains("e-swimlane-row")?e.insertAdjacentElement("beforebegin",i):e.appendChild(i))}))},n.prototype.initializeSwimlaneTree=function(){if(this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&0!==this.parent.kanbanData.length){var e=this.parent.element.querySelector("."+it);if(this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.swimlaneSettings.template){var n=this.swimlaneData[this.swimlaneRow[0].keyField].length,r=(0,t.extend)({},this.swimlaneRow[0],{count:n},!0),a=this.parent.templateParser(this.parent.swimlaneSettings.template)(r,this.parent,"swimlaneTemplate","",!1);e.appendChild(a[0])}else e.innerHTML=this.swimlaneRow[0].textField}},n.prototype.renderSwimlaneRow=function(e,n,r){var a=ge+" "+me,i=r?" "+Be:"",o=(0,t.createElement)("tr",{className:a+i,attrs:{"aria-label":n.keyField+" row header",role:"row","data-key":n.keyField,"aria-expanded":(!r).toString()}}),l=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,s=(0,t.createElement)("td",{className:de,attrs:{"data-role":"kanban-column",role:"gridcell",colspan:l.toString()}}),d=(0,t.createElement)("div",{className:rt});s.appendChild(d);var c=r?ye:fe,p=(0,t.createElement)("div",{className:G+" "+c,attrs:{tabindex:"0",role:"button","aria-label":r?n.keyField+" Collapse":n.keyField+" Expand"}});d.appendChild(p);var u=(0,t.createElement)("div",{className:re});d.appendChild(u);var g=this.swimlaneData[n.keyField].length;if(this.parent.swimlaneSettings.template){var m=(0,t.extend)({},n,{count:g},!0);(0,t.addClass)([s],J);var f=this.parent.element.id+"_swimlaneTemplate",y=this.parent.templateParser(this.parent.swimlaneSettings.template)(m,this.parent,"swimlaneTemplate",f,!1);(0,t.append)(y,u)}else u.appendChild((0,t.createElement)("div",{className:"e-swimlane-text",innerHTML:n.textField,attrs:{"data-role":n.textField}}));this.parent.swimlaneSettings.showItemCount&&d.appendChild((0,t.createElement)("div",{className:ve,innerHTML:"- "+g.toString()+" "+this.parent.localeObj.getConstant("items")})),o.appendChild(s);var v={data:[{keyField:n.keyField,textField:n.textField,count:n.count}],element:o,cancel:!1,requestType:"swimlaneRow"};this.parent.trigger(h,v,(function(t){t.cancel||(e.classList.contains("e-swimlane-row")?e.insertAdjacentElement("beforebegin",o):e.appendChild(o))}))},n.prototype.renderCards=function(){var e=this,n=this.swimlaneRow,r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),i=[],o=!1;r.forEach((function(r,l){for(var s=0,d=function(a){if(e.isColumnVisible(a)){var i=e.parent.swimlaneSettings.keyField?e.getColumnData(a.keyField,e.parent.swimlaneSettings.showEmptyRow&&(0,t.isNullOrUndefined)(e.swimlaneData[n[l].keyField])?[]:e.swimlaneData[n[l].keyField]):e.columnData[a.keyField];s+=i.length;var d=r.querySelector('[data-key="'+a.keyField+'"]'),c=(0,t.createElement)("div",{className:be,attrs:{role:"listbox",tabindex:"0","aria-label":a.keyField.toString()}});if(a.transitionColumns.length>0&&(o=!0),!o&&(0,t.isNullOrUndefined)(e.parent.swimlaneSettings.keyField)){var h=(0,t.createElement)("div",{className:Ge});d.appendChild(h)}if(d.appendChild(c),i.length>0)for(var u=function(n){var r=n[e.parent.cardSettings.headerField],a=e.parent.actionModule.selectionArray.indexOf(r),i=e.renderCard(n);-1!==a&&(i.setAttribute("aria-selected","true"),(0,t.addClass)([i],tt));var o={data:n,element:i,cancel:!1};e.parent.trigger(p,o,(function(e){e.cancel||c.appendChild(i)}))},g=0,m=i;g<m.length;g++){u(m[g])}else c.appendChild(e.renderEmptyCard())}},c=0,h=e.parent.columns;c<h.length;c++){d(h[c])}0===s&&(i.push(r),a.length>0&&i.push(a[l]))})),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||i.forEach((function(e){return(0,t.remove)(e)}))},n.prototype.renderCard=function(e){var n=(0,t.createElement)("div",{className:Ce,attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1",role:"option","aria-roledescription":"Card"}});if("auto"!==this.parent.cardHeight&&(n.style.height=(0,t.formatUnit)(this.parent.cardHeight)),this.parent.cardSettings.template){(0,t.addClass)([n],J);var r=this.parent.element.id+"_cardTemplate",a=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"cardTemplate",r,!1);(0,t.append)(a,n)}else{var i=this.parent.enableTooltip?" "+nt:"";if(this.parent.cardSettings.showHeader){var o=(0,t.createElement)("div",{className:xe}),l=(0,t.createElement)("div",{className:Ae}),s=(0,t.createElement)("div",{className:Fe+i,innerHTML:e[this.parent.cardSettings.headerField]||""});o.appendChild(l),l.appendChild(s),n.appendChild(o)}var d=(0,t.createElement)("div",{className:De+i,innerHTML:e[this.parent.cardSettings.contentField]||""});if(n.appendChild(d),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var c=(0,t.createElement)("div",{className:Me}),p=0,h=e[this.parent.cardSettings.tagsField].toString().split(",");p<h.length;p++){var u=h[p];c.appendChild((0,t.createElement)("div",{className:Te+" "+qe,innerHTML:u}))}n.appendChild(c)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&((0,t.addClass)([n],je),n.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var g=(0,t.createElement)("div",{className:Re}),m=0,f=e[this.parent.cardSettings.footerCssField].split(",");m<f.length;m++){var y=f[m];g.appendChild((0,t.createElement)("div",{className:y.trim()+" "+Pe}))}n.appendChild(g)}}return n},n.prototype.renderEmptyCard=function(){return(0,t.createElement)("span",{className:Le,innerHTML:this.parent.localeObj.getConstant("noCard"),attrs:{"aria-label":this.parent.localeObj.getConstant("noCard"),role:"option"}})},n.prototype.renderColGroup=function(e){var n=this,r=(0,t.createElement)("colgroup");this.parent.columns.forEach((function(e){if(n.isColumnVisible(e)){var a=n.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),i=e.allowToggle&&!e.isExpanded,o=-1===a?i?Be:"":Be,l=(0,t.createElement)("col",{className:o,attrs:{"data-key":e.keyField.toString()},styles:n.parent.isAdaptive?"width: "+(i?(0,t.formatUnit)(O):(0,t.formatUnit)(n.getWidth())):""});r.appendChild(l)}})),e.appendChild(r)},n.prototype.getRows=function(){var e=this,n=[];return this.parent.swimlaneSettings.keyField?(this.parent.kanbanData.map((function(r){if(e.parent.swimlaneSettings.showEmptyRow||!((0,t.isNullOrUndefined)(r[e.parent.keyField])||""===r[e.parent.keyField]||r[e.parent.keyField]&&-1===e.columnKeys.indexOf(r[e.parent.keyField].toString()))){var a=r[e.parent.swimlaneSettings.textField]||r[e.parent.swimlaneSettings.keyField],i=r[e.parent.swimlaneSettings.keyField];if(!r[e.parent.swimlaneSettings.keyField]){if(!e.parent.swimlaneSettings.showUnassignedRow)return;a=e.parent.localeObj.getConstant("unassigned"),i=""}n.push({keyField:i,textField:a})}})),n=n.filter((function(e,t,n){return t===n.map((function(e){return e.keyField})).indexOf(e.keyField)})),(n=this.swimlaneSorting(n)).forEach((function(t){t.count=e.parent.kanbanData.filter((function(n){return e.columnKeys.indexOf(n[e.parent.keyField])>-1&&n[e.parent.swimlaneSettings.keyField]===t.keyField})).length})),0===n.length&&n.push({keyField:"",textField:""})):n.push({keyField:"",textField:""}),n},n.prototype.swimlaneSorting=function(e){return this.parent.swimlaneSettings.sortComparer?e=this.parent.swimlaneSettings.sortComparer.call(this.parent,e):(e.sort((function(e,t){return e.textField.localeCompare(t.textField,void 0,{numeric:!0})})),"Descending"===this.parent.swimlaneSettings.sortDirection&&e.reverse()),e},n.prototype.createStackedRow=function(e){var n=(0,t.createElement)("tr",{className:ue+" "+le}),r=[];this.parent.columns.forEach((function(t){for(var n="",a=0,i=e;a<i.length;a++){var o=i[a];-1!==o.keyFields.indexOf(t.keyField.toString())&&(n=o.text)}r.push(n)}));for(var a=0;a<r.length;a++){for(var i=1,o=a+1;o<r.length&&(""!==r[a]&&""!==r[o]&&r[a]===r[o]);o++)i++;var l=(0,t.createElement)("div",{className:ie,innerHTML:r[a]}),s=(0,t.createElement)("th",{className:ne+" "+se,attrs:{colspan:i.toString(),scope:"col"}});n.appendChild(s).appendChild(l),a+=i-1}return n},n.prototype.scrollUiUpdate=function(){var e=this,n=this.parent.element.querySelector("."+ee),r=this.parent.element.querySelector("."+ce),a=this.parent.element.offsetHeight-n.offsetHeight;if(this.parent.isAdaptive){a=window.innerHeight-(n.offsetHeight+E);var i=this.parent.element.querySelector("."+rt);i&&(a-=i.offsetHeight),[].slice.call(this.parent.element.querySelectorAll("."+de)).forEach((function(n){var r=n.querySelector("."+be);r.classList.contains(Ze)||(r.style.height=(0,t.formatUnit)(a),t.EventHandler.add(n,"touchmove",e.onAdaptiveScroll,e))}))}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(r.style.height=(0,t.formatUnit)(a)),[].slice.call(n.children).forEach((function(n){var a=0;r.offsetWidth-r.clientWidth>0&&(a=17,r.offsetHeight-r.clientHeight>0&&(n.style.width=(0,t.formatUnit)(r.clientWidth))),e.parent.enableRtl?n.style.paddingLeft=(0,t.formatUnit)(a):n.style.paddingRight=(0,t.formatUnit)(a)})),this.updateScrollPosition()},n.prototype.onContentScroll=function(e){var n=e.target,r=this.parent.element.querySelector("."+ee);[].slice.call(r.children).forEach((function(e){e.scrollLeft=n.scrollLeft})),this.parent.scrollPosition.content={left:n.scrollLeft,top:n.scrollTop},!(0,t.isNullOrUndefined)(this.parent.swimlaneSettings.keyField)&&this.parent.swimlaneSettings.enableFrozenRows&&this.frozenRows(e)},n.prototype.addFrozenSwimlaneDataKey=function(e){var n=e.getAttribute("data-key");(0,t.isNullOrUndefined)(n)||this.frozenSwimlaneRow.setAttribute("data-key",n)},n.prototype.frozenRows=function(e){var n=this.parent.element.querySelector("."+me),r=this.parent.element.querySelector("."+ee),a=this.parent.element.querySelector("."+ce);if((0,t.isNullOrUndefined)(this.frozenSwimlaneRow)){this.frozenSwimlaneRow=(0,t.createElement)("div",{className:bt});var i=(0,t.createElement)("div",{className:St});this.frozenSwimlaneRow.appendChild(i),this.parent.element.insertBefore(this.frozenSwimlaneRow,this.parent.element.firstElementChild),i.appendChild(n.querySelector("."+rt).cloneNode(!0)),this.addFrozenSwimlaneDataKey(n),(0,t.setStyleAttribute)(this.frozenSwimlaneRow,{height:(0,t.formatUnit)(n.getBoundingClientRect().height),width:(0,t.formatUnit)(a.querySelector(".e-swimlane").getBoundingClientRect().width),top:(0,t.formatUnit)(r.getBoundingClientRect().height.toString())}),(0,t.setStyleAttribute)(r,{position:"relative",top:(0,t.formatUnit)(-this.frozenSwimlaneRow.getBoundingClientRect().height)}),(0,t.setStyleAttribute)(a,{position:"relative",top:(0,t.formatUnit)(-this.frozenSwimlaneRow.getBoundingClientRect().height)})}else{var o=[].slice.call(this.parent.element.querySelectorAll("."+me)),l=o[this.frozenOrder],s=o[this.frozenOrder-1],d=o[this.frozenOrder+1],c=void 0,p=void 0,h=void 0;l&&(c=l.getBoundingClientRect().top+l.getBoundingClientRect().height),s&&(p=s.getBoundingClientRect().top+s.getBoundingClientRect().height),d&&(h=d.getBoundingClientRect().top+d.getBoundingClientRect().height);var u=a.getBoundingClientRect().top+this.frozenSwimlaneRow.getBoundingClientRect().height,g=this.frozenSwimlaneRow.querySelector("."+St);h&&u>=h&&this.frozenOrder<o.length-1?(g&&((0,t.remove)(g.querySelector("."+rt)),g.appendChild(d.querySelector("."+rt).cloneNode(!0)),this.addFrozenSwimlaneDataKey(d)),++this.frozenOrder):p&&u<c&&u>p&&this.frozenOrder>0&&(g&&((0,t.remove)(g.querySelector("."+rt)),g.appendChild(s.querySelector("."+rt).cloneNode(!0)),this.addFrozenSwimlaneDataKey(s)),--this.frozenOrder)}e&&0===e.target.scrollTop&&this.removeFrozenRows()},n.prototype.removeFrozenRows=function(){(0,t.remove)(this.frozenSwimlaneRow),this.frozenSwimlaneRow=null;var e=this.parent.element.querySelector("."+ee),n=this.parent.element.querySelector("."+ce);(0,t.setStyleAttribute)(e,{position:"",top:""}),(0,t.setStyleAttribute)(n,{position:"",top:""}),this.parent.scrollPosition.content={left:this.parent.scrollPosition.content.left,top:0},n.scrollTop=0,this.frozenOrder=0},n.prototype.onColumnScroll=function(e){var t=e.target;if(t.offsetParent){var n=t.offsetParent.getAttribute("data-key");this.parent.scrollPosition.column[""+n]={left:t.scrollLeft,top:t.scrollTop}}},n.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},n.prototype.isColumnVisible=function(e){var t=this,n=!1;return"number"==typeof e.keyField?n=-1===this.parent.actionModule.hideColumnKeys.indexOf(e.keyField.toString()):e.keyField.split(",").forEach((function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)})),n},n.prototype.renderLimits=function(e,n){var r=(0,t.createElement)("div",{className:dt});e.minCount&&r.appendChild((0,t.createElement)("div",{className:pt,innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&r.appendChild((0,t.createElement)("div",{className:ct,innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),r.childElementCount>0&&(n.querySelector("."+be)?n.insertBefore(r,n.firstElementChild):n.appendChild(r))},n.prototype.renderValidation=function(){var e=this;this.parent.columns.forEach((function(n){if(n.minCount||n.maxCount){var r=e.columnData[n.keyField],a='[data-key="'+n.keyField+'"]',i=e.parent.element.querySelector("."+(ne+a)),o=[].slice.call(e.parent.element.querySelectorAll("."+(de+a)));if("Swimlane"===e.parent.constraintType&&e.parent.swimlaneSettings.keyField)e.swimlaneRow.forEach((function(a,i){e.renderLimits(n,o[i]);var l=r.filter((function(t){return t[e.parent.swimlaneSettings.keyField]===a.keyField})),s=e.getValidationClass(n,l.length);s&&(0,t.addClass)([o[i]],s)}));else{e.renderLimits(n,i);var l=e.getValidationClass(n,r.length);l&&(0,t.addClass)(o.concat(i),l)}}}))},n.prototype.getValidationClass=function(e,t){var n;return e.maxCount&&t>e.maxCount?n=ht:e.minCount&&t<e.minCount&&(n=ut),n},n.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll("."+dt)).forEach((function(e){(0,t.remove)(e)}));var e=[].slice.call(this.parent.element.querySelectorAll("."+ut));(0,t.removeClass)(e,ut);var n=[].slice.call(this.parent.element.querySelectorAll("."+ht));(0,t.removeClass)(n,ht),this.renderValidation()},n.prototype.getColumnData=function(e,t){var n=this;void 0===t&&(t=this.parent.kanbanData);var r=[];if("number"==typeof e){var a=t.filter((function(t){return t[n.parent.keyField]===e}));r=r.concat(a)}else for(var i=function(e){var a=t.filter((function(t){return t[n.parent.keyField]===e.trim()}));r=r.concat(a)},o=0,l=e.split(",");o<l.length;o++){i(l[o])}return this.sortCategory(r),r},n.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,n=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,n,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,n,e)}return e},n.prototype.sortOrder=function(e,t,n){var r,a,i=!0;return this.parent.kanbanData.length>0&&(i="number"==typeof this.parent.kanbanData[0][""+e]),i||"Index"!==this.parent.sortSettings.sortBy?(n=n.sort((function(t,n){return i?(r=t[""+e],a=n[""+e]):(r=t[""+e]?t[""+e].toLowerCase():"",a=n[""+e]?n[""+e].toLowerCase():""),r>a?1:a>r?-1:0})),"Descending"===t&&n.reverse(),n):n},n.prototype.documentClick=function(e){if(e.target.classList.contains(ot)&&this.parent.element.querySelector("."+st).classList.contains("e-popup-open")&&(this.treePopup.hide(),(0,t.removeClass)([this.popupOverlay],"e-enable")),!(0,t.closest)(e.target,"."+Y)){var n=[].slice.call(this.parent.element.querySelectorAll("."+Ce+"."+tt));(0,t.removeClass)(n,tt),this.disableAttributeSelection(n)}},n.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach((function(e){e.setAttribute("aria-selected","false")}))},n.prototype.getColumnCards=function(e){var t=this,n={};return this.columnKeys=[],this.parent.columns.forEach((function(r){var a="number"==typeof r.keyField;t.columnKeys=a?t.columnKeys.concat(r.keyField.toString()):t.columnKeys.concat(r.keyField.split(",").map((function(e){return e.trim()})));var i=t.getColumnData(r.keyField,e);n[r.keyField]=i})),n},n.prototype.getSwimlaneCards=function(){var e=this,n={};return this.parent.swimlaneSettings.keyField&&this.kanbanRows.forEach((function(r){return n[r.keyField]=e.parent.kanbanData.filter((function(n){return!(0,t.isNullOrUndefined)(n[e.parent.keyField])&&e.columnKeys.indexOf(n[e.parent.keyField].toString())>-1&&(!n[e.parent.swimlaneSettings.keyField]&&e.parent.swimlaneSettings.showUnassignedRow?"":n[e.parent.swimlaneSettings.keyField])===r.keyField}))})),n},n.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector("."+ee);[].slice.call(e.children).forEach((function(e){return(0,t.remove)(e)})),this.renderHeader(e)},n.prototype.refreshCards=function(){this.parent.resetTemplates(["cardTemplate"]),[].slice.call(this.parent.element.querySelectorAll("."+be)).forEach((function(e){return(0,t.remove)(e)})),this.renderCards(),this.wireDragEvent(),this.parent.renderTemplates()},n.prototype.refresh=function(){var e=this,t=!1;(this.parent.columns.forEach((function(n){if(n.showItemCount){n&&n.template&&!t&&(e.refreshHeaders(),t=!0);var r="."+ne+'[data-key="'+n.keyField+'"] .'+ve,a=e.parent.element.querySelector(r);if(a){var i=0;if("number"==typeof n.keyField)i=[].slice.call(e.parent.element.querySelectorAll("."+Ce+'[data-key="'+n.keyField+'"]')).length;else for(var o=0,l=n.keyField.split(",");o<l.length;o++){var s=l[o];i=[].slice.call(e.parent.element.querySelectorAll("."+Ce+'[data-key="'+s.trim()+'"]')).length+i}a.innerHTML="-"+i+""+e.parent.localeObj.getConstant("items")}}})),this.parent.swimlaneSettings.keyField)&&[].slice.call(this.parent.element.querySelectorAll("."+me)).forEach((function(t){var n=t.getAttribute("data-key"),r=t.querySelector("."+ve);if(r&&n){var a=[].slice.call(t.nextElementSibling.querySelectorAll("."+Ce));r.innerHTML="-"+a.length+""+e.parent.localeObj.getConstant("items")}}));this.refreshValidation()},n.prototype.updateScrollPosition=function(){var e=this,n=this.parent.element.querySelector("."+ce);n&&(t.Browser.isIE?(n.scrollTop=this.parent.scrollPosition.content.top,n.scrollLeft=this.parent.scrollPosition.content.left):n.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top)),[].slice.call(this.parent.element.querySelectorAll("."+be)).forEach((function(n){if(n.offsetParent){var r=e.parent.scrollPosition.column[n.offsetParent.getAttribute("data-key")];r&&(t.Browser.isIE?(n.scrollTop=r.top,n.scrollLeft=r.left):n.scrollTo(r.left,r.top))}}))},n.prototype.renderCardBasedOnIndex=function(e,n){var r=this,a=e[this.parent.keyField],i=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");if(this.parent.swimlaneSettings.keyField&&!this.parent.isAdaptive){var o='.e-content-row.e-swimlane-row[data-key="'+e[this.parent.swimlaneSettings.keyField]+'"]';if(this.parent.element.querySelector(o))i=this.parent.element.querySelector(o).nextElementSibling;else{if(-1!==this.columnKeys.indexOf(a)&&-1===this.parent.actionModule.hideColumnKeys.indexOf(a)){var l=this.kanbanRows.findIndex((function(t){return t.keyField===e[r.parent.swimlaneSettings.keyField]})),s=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row")),d=this.parent.element.querySelector("."+pe+" tbody");s[l]&&(d=s[l]),this.renderSwimlaneRow(d,this.kanbanRows[l],!1),this.renderSingleContent(d,this.kanbanRows[l],!1)}i=this.parent.element.querySelector(o).nextElementSibling,[].slice.call(i.children).forEach((function(e){var n=(0,t.createElement)("div",{className:be});e.appendChild(n),n.appendChild(r.renderEmptyCard())}))}}if("Index"!==this.parent.sortSettings.sortBy){var c=this.parent.cardSettings.headerField;if("Custom"===this.parent.sortSettings.sortBy&&(c=this.parent.sortSettings.field),(0,t.isNullOrUndefined)(this.parent.swimlaneSettings.keyField))n=this.getColumnData(a,this.parent.kanbanData).findIndex((function(t){return t[""+c]===e[""+c]}));else{var h=this.parent.getSwimlaneData(e[this.parent.swimlaneSettings.keyField]);n=this.getColumnData(a,h).findIndex((function(t){return t[""+c]===e[""+c]}))}}else"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(n=e[this.parent.sortSettings.field]-1);if(i){var u=[].slice.call(i.children).filter((function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(a.toString().replace(/\s/g,""))}))[0],g=u.querySelector("."+be),m=g.querySelector("."+Le);m&&(0,t.remove)(m);var f=this.renderCard(e);this.parent.allowDragAndDrop&&u.classList.contains(Ee)&&(this.parent.dragAndDropModule.wireDragEvents(f),(0,t.addClass)([f],we));var y={data:e,element:f,cancel:!1};this.parent.trigger(p,y,(function(e){e.cancel||((0,t.isNullOrUndefined)(n)||0===g.children.length?g.appendChild(f):g.insertBefore(f,g.childNodes[n]))}))}},n.prototype.removeCard=function(e){var n=e[this.parent.cardSettings.headerField],r=this.parent.element.querySelector("."+Ce+'[data-id="'+n+'"]');if(r){this.isSelectedCard=!!r.classList.contains(tt);var a=r.parentElement;(0,t.remove)(r),0===a.querySelectorAll("."+Ce+":not(."+We+")").length&&a.appendChild(this.renderEmptyCard())}},n.prototype.wireEvents=function(){var e=this;t.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),t.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),t.EventHandler.add(document,t.Browser.touchStartEvent,this.documentClick,this);var n=this.parent.element.querySelector("."+ce);t.EventHandler.add(n,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll("."+be)).forEach((function(n){e.parent.isInitialRender&&n.offsetParent&&(e.parent.scrollPosition.column[n.offsetParent.getAttribute("data-key")]={left:0,top:0}),t.EventHandler.add(n,"scroll",e.onColumnScroll,e)})),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),n.scrollLeft=this.scrollLeft),this.wireDragEvent()},n.prototype.unWireEvents=function(){var e=this;t.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),t.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),t.EventHandler.remove(document,t.Browser.touchStartEvent,this.documentClick);var n=this.parent.element.querySelector("."+ce);n&&(t.EventHandler.remove(n,"scroll",this.onContentScroll),this.parent.allowDragAndDrop&&this.unWireDragEvent());var r=[].slice.call(this.parent.element.querySelectorAll("."+be));r.length>0&&r.forEach((function(n){t.EventHandler.remove(n,"scroll",e.onColumnScroll)})),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},n.prototype.wireDragEvent=function(){var e=this;if(this.parent.allowDragAndDrop){var n=[].slice.call(this.parent.element.querySelectorAll("."+de+"."+Ee+" ."+Ce));(0,t.addClass)(n,we),n.forEach((function(t){return e.parent.dragAndDropModule.wireDragEvents(t)}))}},n.prototype.unWireDragEvent=function(){var e=this,n=[].slice.call(this.parent.element.querySelectorAll("."+de+"."+Ee+" ."+Ce));(0,t.removeClass)(n,we),n.forEach((function(t){return e.parent.dragAndDropModule.unWireDragEvents(t)}))},n.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(w,this.initRender),this.parent.off(C,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector("."+ee);e&&(0,t.remove)(e);var n=this.parent.element.querySelector("."+ce);n&&(0,t.remove)(n),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var r=this.parent.element.querySelector("."+rt);r&&(0,t.remove)(r);var a=this.parent.element.querySelector("."+lt);a&&(0,t.remove)(a)},n}(jt),Lt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(e){function n(t){var n=e.call(this,t)||this;return n.parent=t,n.kanbanRows=[],n.scrollStatus={},n.offsets={},n.tempOffsets={},n.offsetKeys=[],n.columnKeys=[],n.scrollLeft=0,n.frozenOrder=0,n.winResize=n.windowResize.bind(n),n.parent.enableVirtualization&&(n.parent.on(w,n.initRender,n),n.parent.on(C,n.scrollUiUpdate,n)),n}return Lt(n,e),n.prototype.initRender=function(){if(this.isSwimlane=!(0,t.isNullOrUndefined)(this.parent.swimlaneSettings.keyField)&&this.parent.swimlaneSettings.keyField.trim().length>1,this.query=this.parent.query instanceof r.Query?this.parent.query:new r.Query,0!==this.parent.columns.length){if(this.cardHeight=this.cardHeightCalculate(),this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.parent.isAdaptive){var e=this.parent.element.querySelector("."+ce);e&&(this.scrollLeft=e.scrollLeft)}this.destroy(),this.parent.on(w,this.initRender,this),this.parent.on(C,this.scrollUiUpdate,this);var n=(0,t.createElement)("div",{className:ee});this.parent.element.appendChild(n),this.renderHeader(n),this.isSwimlane||(this.renderContent(),this.renderCards()),this.renderValidation(),this.parent.renderTemplates(),this.parent.notify(C,{}),this.wireEvents(),this.parent.isInitialRender&&(this.parent.isInitialRender=!1)}},n.prototype.cardHeightCalculate=function(){return"auto"===this.parent.cardHeight?108:parseInt((0,t.formatUnit)(this.parent.cardHeight).split("px")[0],10)+8},n.prototype.renderHeader=function(e){var n=(0,t.createElement)("div",{className:this.parent.swimlaneSettings.keyField?Z:""});e.appendChild(n);var r=(0,t.createElement)("table",{className:$+" "+te,attrs:{role:"presentation"}});n.appendChild(r),this.renderColGroup(r);var a=(0,t.createElement)("thead");r.appendChild(a),this.parent.stackedHeaders.length>0&&a.appendChild(this.createStackedRow(this.parent.stackedHeaders));var i=(0,t.createElement)("tr",{className:ue});a.appendChild(i);for(var o=function(e){if(l.isColumnVisible(e)){var n=l.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),r=(0,t.createElement)("th",{className:-1===n?ne:ne+" "+Be,attrs:{"data-role":"kanban-column","data-key":e.keyField.toString()}}),a=[];e.allowToggle&&(a.push(he),e.isExpanded||a.push(Be)),(0,t.addClass)([r],a);var o=(0,t.createElement)("div",{className:re});r.appendChild(o);var s=l.parent.dataModule.isRemote()?l.parent.columnDataCount[e.keyField]:l.columnData[e.keyField].length,d=(0,t.createElement)("div",{className:ae});if(o.appendChild(d),e.template){var c={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:s};(0,t.addClass)([r],J);var p=l.parent.element.id+"_columnTemplate",u=l.parent.templateParser(e.template)(c,l.parent,"columnTemplate",p,!1);(0,t.append)(u,d)}else{var g=(0,t.createElement)("div",{className:ie,innerHTML:e.headerText});if(d.appendChild(g),e.showItemCount){var m=(0,t.createElement)("div",{className:ve,innerHTML:"- "+s.toString()+" "+l.parent.localeObj.getConstant("items")});d.appendChild(m)}}if(e.allowToggle){var f=!(!e.isExpanded||-1!==n),y=f?Ne:He,v=(0,t.createElement)("div",{className:oe+" "+G+" "+y,attrs:{tabindex:"0"}});v.setAttribute("aria-label",f?e.keyField+" Expand":e.keyField+" Collapse"),r.setAttribute("aria-expanded",f.toString()),o.appendChild(v)}var b={data:[{keyField:e.keyField,textField:e.headerText,count:s}],element:i,cancel:!1,requestType:"headerRow"};l.parent.trigger(h,b,(function(e){e.cancel||i.appendChild(r)}))}},l=this,s=0,d=this.parent.columns;s<d.length;s++){o(d[s])}},n.prototype.renderContent=function(){var e=(0,t.createElement)("div",{className:ce});this.parent.element.appendChild(e);var n=(0,t.createElement)("div",{className:this.parent.swimlaneSettings.keyField?Z:""});e.appendChild(n);var r=(0,t.createElement)("table",{className:$+" "+pe,attrs:{role:"presentation"}});n.appendChild(r),this.renderColGroup(r);var a=(0,t.createElement)("tbody");r.appendChild(a);for(var i=!1,o=0,l=this.kanbanRows;o<l.length;o++){var s=l[o];if(this.parent.swimlaneSettings.keyField&&0!==this.parent.swimlaneToggleArray.length)i=-1!==this.parent.swimlaneToggleArray.indexOf(s.keyField);this.renderSingleContent(a,s,i)}},n.prototype.renderSingleContent=function(e,n,r){for(var a=r?ge+" "+Be:ge,i=(0,t.createElement)("tr",{className:a,attrs:{"aria-expanded":"true"}}),o=0,l=this.parent.columns;o<l.length;o++){var s=l[o];if(this.isColumnVisible(s)){var d=this.parent.actionModule.columnToggleArray.indexOf(s.keyField.toString()),c=-1===d?de:de+" "+Be,p=(s.allowDrag?" "+Ee:"")+(s.allowDrop?" "+ke+" "+we:""),u=(0,t.createElement)("td",{className:c+p,attrs:{"data-role":"kanban-column","data-key":s.keyField.toString(),"aria-expanded":"true",tabindex:"0",role:"navigation"}});if(s.allowToggle&&!s.isExpanded||-1!==d){(0,t.addClass)([u],Be);var g=(s.showItemCount?"["+(this.parent.dataModule.isRemote()?this.parent.columnDataCount[s.keyField]:this.getColumnData(s.keyField).length)+"] ":"")+s.headerText;u.appendChild((0,t.createElement)("div",{className:Ie,innerHTML:g})),u.setAttribute("aria-expanded","false")}if(s.showAddButton){var m=(0,t.createElement)("div",{className:ft,attrs:{tabindex:"-1"}});m.appendChild((0,t.createElement)("div",{className:yt+" "+G})),u.appendChild(m)}if(i.appendChild(u),this.parent.enableVirtualization){var f=this.parent.element.querySelector(".e-kanban-header").getBoundingClientRect().height;"auto"===this.parent.height?u.style.height=window.innerHeight-(f+this.parent.element.getBoundingClientRect().top+15)+"px":u.style.height=parseInt((0,t.formatUnit)(this.parent.height).split("px")[0],10)-(f+15)+"px"}}}var y={data:[{keyField:n.keyField,textField:n.textField,count:n.count}],element:i,cancel:!1,requestType:"contentRow"};this.parent.trigger(h,y,(function(t){t.cancel||(e.classList.contains("e-swimlane-row")?e.insertAdjacentElement("beforebegin",i):e.appendChild(i))}))},n.prototype.windowResize=function(){for(var e=this.parent.element.querySelectorAll("."+de),n=this.parent.element.querySelector(".e-kanban-header").getBoundingClientRect().height,r=0;r<e.length;r++)"auto"===this.parent.height?e[r].style.height=window.innerHeight-(n+this.parent.element.getBoundingClientRect().top+15)+"px":e[r].style.height=parseInt((0,t.formatUnit)(this.parent.height).split("px")[0],10)-(n+15)+"px"},n.prototype.refreshColumnData=function(e,n,r,a){var i=this,o=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),l=("cardChanged"===r||"cardCreated"===r||"cardRemoved"===r)&&!(0,t.isNullOrUndefined)(a);o.forEach((function(t){for(var r=function(r){if(i.isColumnVisible(r)&&(r.keyField===e||r.keyField===n)||l){var a,o=0,s=i.getColumnCards()[r.keyField],d=i.parent.dataModule.isRemote()?i.parent.columnDataCount[r.keyField]:s.length,c=i.cardHeight*d;a=Array.apply(null,Array(d)).map((function(){return++o}));var p=t.querySelector('[data-key="'+r.keyField+'"]'),h=Math.ceil(parseInt(p.style.height.split("px")[0],10)/i.cardHeight);i.offsets[1]=h*i.cardHeight;for(var u=1;u<a.length;u++)i.offsets[a[u]]=i.offsets[a[u-1]]+h*i.cardHeight,i.tempOffsets[a[u]]=0|i.offsets[a[u]-1];var g=p.querySelector("."+be),m=d%2==0?d-2:d-1,f=i.getInfoFromView(i.scrollStatus[r.keyField]),y=i.getTranslateY(f),v=g.querySelector("."+Se);v.style.maxHeight=d*i.cardHeight+"px",i.setPadding(y,v,d),i.currentStatus={column:r.keyField,columnOverAllHeight:c,columnHeight:parseInt(p.style.height.split("px")[0],10),previousScrollTop:i.scrollStatus[r.keyField].currentScrollTop,currentScrollTop:g.scrollTop,scrollDirection:i.scrollStatus[r.keyField].scrollDirection,currentBlockIndex:i.scrollStatus[r.keyField].currentBlockIndex,oldBlockIndex:i.scrollStatus[r.keyField].oldBlockIndex,offsets:i.offsets,tempOffsets:i.tempOffsets,totalColumnData:d,singleIndexCardCount:h,maxBlock:m},i.scrollStatus[r.keyField]=i.currentStatus}},a=0,o=i.parent.columns;a<o.length;a++){r(o[a])}}))},n.prototype.renderCards=function(){var e=this,n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),a=[],i=!1;n.forEach((function(n,o){for(var l=0,s=function(r){if(e.isColumnVisible(r)){var a,o=0;e.offsets={},e.tempOffsets={};var s=e.columnData[r.keyField],d=e.parent.dataModule.isRemote()?e.parent.columnDataCount[r.keyField]:s.length;l+=d;var c=e.cardHeight*d+7,h=n.querySelector('[data-key="'+r.keyField+'"]'),u=Math.ceil(parseFloat(h.style.height.split("px")[0])/e.cardHeight),g=u>d?d:Math.floor(d/u);a=Array.apply(null,Array(d)).map((function(){return++o})),e.offsets[1]=u*e.cardHeight+7;for(var m=1;m<a.length;m++)e.offsets[a[m]]=e.offsets[a[m-1]]+u*e.cardHeight,e.tempOffsets[a[m]]=0|e.offsets[a[m]-1];var f=(0,t.createElement)("div",{className:be,attrs:{role:"listbox"}}),y=(0,t.createElement)("div",{className:Se,attrs:{role:"listbox"}});f.appendChild(y);var v=g%2==0?g:g+1;if(e.currentStatus={column:r.keyField,columnOverAllHeight:c,columnHeight:parseInt(h.style.height.split("px")[0],10),previousScrollTop:null,currentScrollTop:f.scrollTop,scrollDirection:null,currentBlockIndex:[1,2],oldBlockIndex:[1,2],offsets:e.offsets,tempOffsets:e.tempOffsets,totalColumnData:d,singleIndexCardCount:u,maxBlock:v},e.scrollStatus[r.keyField]=e.currentStatus,r.transitionColumns.length>0&&(i=!0),!i&&(0,t.isNullOrUndefined)(e.parent.swimlaneSettings.keyField)){var b=(0,t.createElement)("div",{className:Ge});h.appendChild(b)}if(h.appendChild(f),d>0){var S=function(n){var r=s[n][e.parent.cardSettings.headerField],a=e.parent.actionModule.selectionArray.indexOf(r),i=e.renderCard(s[n]);-1!==a&&(i.setAttribute("aria-selected","true"),(0,t.addClass)([i],tt));var o={data:s[n],element:i,cancel:!1};e.parent.trigger(p,o,(function(e){e.cancel||y.appendChild(i)}))};for(m=0;m<2*u&&m<s.length;m++)S(m);y.style.maxHeight=e.cardHeight*d+"px"}else y.appendChild(e.renderEmptyCard());e.setPadding(0,y,d)}},d=0,c=e.parent.columns;d<c.length;d++){s(c[d])}0===l&&(a.push(n),r.length>0&&a.push(r[o]))})),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||a.forEach((function(e){return(0,t.remove)(e)}))},n.prototype.renderCard=function(e){var n=(0,t.createElement)("div",{className:Ce,attrs:{"data-id":e[this.parent.cardSettings.headerField],"data-key":e[this.parent.keyField],"aria-selected":"false",tabindex:"-1",role:"option"}});if(n.style.height=this.cardHeight-8+"px",this.parent.cardSettings.template){(0,t.addClass)([n],J);var r=this.parent.element.id+"_cardTemplate",a=this.parent.templateParser(this.parent.cardSettings.template)(e,this.parent,"cardTemplate",r,!1);(0,t.append)(a,n)}else{var i=this.parent.enableTooltip?" "+nt:"";if(this.parent.cardSettings.showHeader){var o=(0,t.createElement)("div",{className:xe}),l=(0,t.createElement)("div",{className:Ae}),s=(0,t.createElement)("div",{className:Fe+i,innerHTML:e[this.parent.cardSettings.headerField]||""});o.appendChild(l),l.appendChild(s),n.appendChild(o)}var d=(0,t.createElement)("div",{className:De+i,innerHTML:e[this.parent.cardSettings.contentField]||""});if(n.appendChild(d),this.parent.cardSettings.tagsField&&e[this.parent.cardSettings.tagsField]){for(var c=(0,t.createElement)("div",{className:Me}),p=0,h=e[this.parent.cardSettings.tagsField].toString().split(",");p<h.length;p++){var u=h[p];c.appendChild((0,t.createElement)("div",{className:Te+" "+qe,innerHTML:u}))}n.appendChild(c)}if(this.parent.cardSettings.grabberField&&e[this.parent.cardSettings.grabberField]&&((0,t.addClass)([n],je),n.style.borderLeftColor=e[this.parent.cardSettings.grabberField]),this.parent.cardSettings.footerCssField){for(var g=(0,t.createElement)("div",{className:Re}),m=0,f=e[this.parent.cardSettings.footerCssField].split(",");m<f.length;m++){var y=f[m];g.appendChild((0,t.createElement)("div",{className:y.trim()+" "+Pe}))}n.appendChild(g)}}return n},n.prototype.renderEmptyCard=function(){return(0,t.createElement)("span",{className:Le,innerHTML:this.parent.localeObj.getConstant("noCard")})},n.prototype.renderColGroup=function(e){var n=this,r=(0,t.createElement)("colgroup");this.parent.columns.forEach((function(e){if(n.isColumnVisible(e)){var a=n.parent.actionModule.columnToggleArray.indexOf(e.keyField.toString()),i=e.allowToggle&&!e.isExpanded,o=-1===a?i?Be:"":Be,l=(0,t.createElement)("col",{className:o,attrs:{"data-key":e.keyField.toString()},styles:n.parent.isAdaptive?"width: "+(i?(0,t.formatUnit)(O):(0,t.formatUnit)(n.getWidth())):""});r.appendChild(l)}})),e.appendChild(r)},n.prototype.getRows=function(){var e=[];return e.push({keyField:"",textField:""}),e},n.prototype.createStackedRow=function(e){var n=(0,t.createElement)("tr",{className:ue+" "+le}),r=[];this.parent.columns.forEach((function(t){for(var n="",a=0,i=e;a<i.length;a++){var o=i[a];-1!==o.keyFields.indexOf(t.keyField.toString())&&(n=o.text)}r.push(n)}));for(var a=0;a<r.length;a++){for(var i=1,o=a+1;o<r.length&&(""!==r[a]&&""!==r[o]&&r[a]===r[o]);o++)i++;var l=(0,t.createElement)("div",{className:ie,innerHTML:r[a]}),s=(0,t.createElement)("th",{className:ne+" "+se,attrs:{colspan:i.toString()}});n.appendChild(s).appendChild(l),a+=i-1}return n},n.prototype.scrollUiUpdate=function(){var e=this,n=this.parent.element.querySelector("."+ee),r=this.parent.element.querySelector("."+ce),a=this.parent.element.offsetHeight-n.offsetHeight;if(this.parent.isAdaptive){a=window.innerHeight-(n.offsetHeight+E);var i=this.parent.element.querySelector("."+rt);i&&(a-=i.offsetHeight),[].slice.call(this.parent.element.querySelectorAll("."+de)).forEach((function(n){var r=n.querySelector("."+be);r.classList.contains(Ze)||(r.style.height=(0,t.formatUnit)(a),t.EventHandler.add(n,"touchmove",e.onAdaptiveScroll,e))}))}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(r.style.height=(0,t.formatUnit)(a)),[].slice.call(n.children).forEach((function(n){var a=0;r.offsetWidth-r.clientWidth>0&&(a=17,r.offsetHeight-r.clientHeight>0&&(n.style.width=(0,t.formatUnit)(r.clientWidth))),e.parent.enableRtl?n.style.paddingLeft=(0,t.formatUnit)(a):n.style.paddingRight=(0,t.formatUnit)(a)})),this.updateScrollPosition()},n.prototype.onContentScroll=function(e){var t=e.target,n=this.parent.element.querySelector("."+ee);[].slice.call(n.children).forEach((function(e){e.scrollLeft=t.scrollLeft})),this.parent.scrollPosition.content={left:t.scrollLeft,top:t.scrollTop}},n.prototype.getOffset=function(e,t){return Math.min(0|t.offsets[e],0|t.offsets[t.maxBlock])},n.prototype.getTranslateY=function(e){var t=(e.newBlockIndex[0]||1)-1,n=this.getOffset(t,e),r=this.getOffset(e.newBlockIndex[e.newBlockIndex.length-1],e);return n>e.currentScrollTop?this.getOffset(t-1,e):r<e.currentScrollTop+e.columnHeight?this.getOffset(t+1,e):n},n.prototype.setPadding=function(e,t,n,r,a){r&&"down"===a?(t.style.paddingTop=e+"px",t.style.paddingBottom="0px"):(t.style.paddingTop=e+"px",t.style.paddingBottom=this.cardHeight*n-e+"px")},n.prototype.getData=function(e,t,n,a){var i=this.query.clone(),o=new r.Predicate(e,"equal",t,!0);return i.where(o),i.take(n),i.skip(a),i.addParams("KanbanVirtualScroll","KanbanVirtualScroll"),this.parent.dataSource&&"result"in this.parent.dataSource?this.eventPromise({requestType:""},i).promise:this.parent.dataModule.dataManager.executeQuery(i)},n.prototype.eventPromise=function(e,t){var n=this.getStateEventArgument(t),a=new r.Deferred;return n.updateData=a.resolve,n.action=e,a},n.prototype.getStateEventArgument=function(e){var n=new r.UrlAdaptor,a=new r.DataManager({url:"",adaptor:new r.UrlAdaptor}),i=n.processQuery(a,e),o=JSON.parse(i.data);return(0,t.extend)(o,i.pvtData)},n.prototype.dataManagerSuccess=function(e,n){var r,a=this;return n?r=(0,t.extend)([],(0,t.isNullOrUndefined)(e.result.result)?e.result:e.result.result,null,!0):this.parent.trigger(u,e,(function(e){r=(0,t.extend)([],(0,t.isNullOrUndefined)(e.result.result)?e.result:e.result.result,null,!0),a.parent.trigger(g,null,(function(){return a.parent.hideSpinner()}))})),r},n.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger(o,{error:e},(function(){return t.parent.hideSpinner()}))},n.prototype.onColScrollShowSkeleton=function(e){var t=e.target;if(!(this.parent.element.querySelectorAll(".e-card-skeleton-wrapper").length>0)){var n=t.parentElement.getAttribute("data-key"),r=this.scrollStatus[n].previousScrollTop,a=t.parentElement.clientHeight;(t.scrollTop-r>a||r-t.scrollTop>a)&&this.showSkeleton(t,this.scrollStatus[n].singleIndexCardCount)}},n.prototype.showSkeleton=function(e,n){var r=(0,t.createElement)("div",{className:"e-card-virtual-skeleton-wrapper",attrs:{role:"listbox"}});e.parentElement.insertBefore(r,e),r.style.position="absolute",r.style.zIndex="10";for(var a=0;a<n;a++){var i=(0,t.createElement)("div",{className:"e-card-skeleton-wrapper"}),o=(0,t.createElement)("span",{className:"e-skeleton e-skeleton-text e-shimmer-wave"});o.style.height=this.cardHeight+"px",(0,t.isNullOrUndefined)(e.querySelector(".e-card"))||(o.style.width=e.querySelector(".e-card").getBoundingClientRect().width+"px"),i.appendChild(o),r.appendChild(i)}},n.prototype.hideSkeleton=function(e){setTimeout((function(){for(var n=e.querySelectorAll(".e-card-virtual-skeleton-wrapper"),r=0;r<n.length;r++)(0,t.detach)(n[r])}),50)},n.prototype.onColumnScroll=function(e){var n,r=this,a=e.target,i=a.scrollTop;if(a.offsetParent&&(n=a.offsetParent.getAttribute("data-key"),this.parent.scrollPosition.column[n]={left:a.scrollLeft,top:a.scrollTop}),this.parent.enableVirtualization){var o=a,l=0,s=this.getColumnCards()[n],d=this.parent.dataModule.isRemote()?this.parent.columnDataCount[n]:s.length;l+=d;var c,p,h=this.cardHeight*l;if(this.checkScrollDirection(n,i),"fast"===this.findScrollSpeed(a,n)&&i>h)return void this.hideSkeleton(o.parentElement);var u=this.scrollStatus[n].maxBlock,g=this.scrollStatus[n].currentBlockIndex.indexOf(u)>-1,m=e.timeStamp-this.scrollStatus[n].previousTimeStamps<300;if(g&&!(0,t.isNullOrUndefined)(this.scrollStatus[n].previousTimeStamps)&&m)return void this.hideSkeleton(o.parentElement);this.scrollStatus[n].previousTimeStamps=e.timeStamp;var f=this.getInfoFromView(this.scrollStatus[n]);c=f.currentBlockIndex.filter((function(e){return-1===f.newBlockIndex.indexOf(e)})),p=f.newBlockIndex.filter((function(e){return-1===f.currentBlockIndex.indexOf(e)}));var y=i+a.clientHeight>=h,v=y?h-o.querySelector("."+Se).childElementCount*this.cardHeight:this.getTranslateY(f),b=o.querySelector("."+Se);if(c.length>0){var S=void 0,C=void 0;1===c[0]?(S=0,C=c.length*this.scrollStatus[n].singleIndexCardCount-1):C=(S=(c[0]-1)*this.scrollStatus[n].singleIndexCardCount)+c.length*this.scrollStatus[n].singleIndexCardCount,this.removeCardsOnScroll(b,"down"===this.scrollStatus[n].scrollDirection,S,C)}if(p.length>0)if(this.parent.dataModule.isRemote()){var w=(p[0]-1)*this.scrollStatus[n].singleIndexCardCount,E=[];this.getData(this.parent.keyField,n,this.scrollStatus[n].singleIndexCardCount*p.length,w).then((function(e){E=r.dataManagerSuccess(e),r.scrollCardInsert(n,b,a,i,o,"down"===r.scrollStatus[n].scrollDirection?0:E.length-1,!0,E,null)})).catch((function(e){return r.dataManagerFailure(e)}))}else{w="down"===this.scrollStatus[n].scrollDirection?(p[0]-1)*this.scrollStatus[n].singleIndexCardCount:(p[0]-1)*this.scrollStatus[n].singleIndexCardCount+this.scrollStatus[n].singleIndexCardCount*p.length-1;var k="down"===this.scrollStatus[n].scrollDirection?w+this.scrollStatus[n].singleIndexCardCount*p.length:(p[0]-1)*this.scrollStatus[n].singleIndexCardCount;this.scrollCardInsert(n,b,a,i,o,w,!1,s,k)}this.scrollStatus[n].currentBlockIndex=this.scrollStatus[n].newBlockIndex,this.setPadding(v,b,d,y,this.scrollStatus[n].scrollDirection),f.currentBlockIndex=f.newBlockIndex,this.parent.renderTemplates(),this.hideSkeleton(o.parentElement)}},n.prototype.checkScrollDirection=function(e,t){this.scrollStatus[e].previousScrollTop=this.scrollStatus[e].currentScrollTop,this.scrollStatus[e].currentScrollTop=t,t>this.scrollStatus[e].previousScrollTop?this.scrollStatus[e].scrollDirection="down":this.scrollStatus[e].scrollDirection="up"},n.prototype.findScrollSpeed=function(e,t){return"down"===this.scrollStatus[t].scrollDirection&&e.scrollTop-this.scrollStatus[t].previousScrollTop>e.clientHeight||"up"===this.scrollStatus[t].scrollDirection&&this.scrollStatus[t].previousScrollTop-e.scrollTop>e.clientHeight?"fast":"slow"},n.prototype.removeCardsOnScroll=function(e,n,r,a){for(var i=r;i<a;i++){for(var o=n?e.firstChild:e.lastChild;!(0,t.isNullOrUndefined)(o)&&(o.classList.contains(Ye)||o.classList.contains(Ke)||o.classList.contains(Qe)||o.classList.contains(We));)o=n?o.nextSibling:o.previousSibling;(0,t.isNullOrUndefined)(o)||(0,t.detach)(o)}},n.prototype.scrollCardInsert=function(e,n,r,a,i,o,l,s,d){var c=this,h=l?s.length:d,u=l?0:d;if(s.length>0){for(var g=function(r){if(!(0,t.isNullOrUndefined)(s[r])){var a=s[r][m.parent.cardSettings.headerField],i=m.parent.actionModule.selectionArray.indexOf(a),o=m.renderCard(s[r]);-1!==i&&(o.setAttribute("aria-selected","true"),(0,t.addClass)([o],tt));var l={data:s[r],element:o,cancel:!1};m.parent.trigger(p,l,(function(r){r.cancel||("down"===c.scrollStatus[e].scrollDirection?n.appendChild(o):n.insertBefore(o,n.firstChild),c.parent.dragAndDropModule.wireDragEvents(o),(0,t.addClass)([o],we))}))}},m=this,f=o;"down"===this.scrollStatus[e].scrollDirection?f<h:f>=u;"down"===this.scrollStatus[e].scrollDirection?f++:f--)g(f);r.scrollTop=a}else i.appendChild(this.renderEmptyCard())},n.prototype.ensureColumnNotEmpty=function(e){var n=this.scrollStatus[e].singleIndexCardCount,r=this.columnData[e],a=this.parent.element.querySelector('.e-content-row:not(.e-swimlane-row) [data-key="'+e+'"]').querySelector("."+Se),i=a.querySelectorAll("."+Ce);if(i.length>0){var o=i[i.length-1].getAttribute("data-id"),l=i[0].getAttribute("data-id"),s=void 0,d=void 0;if(i.length<2*n){for(var c=0;c<r.length;c++)o===r[c][this.parent.cardSettings.headerField].toString()&&(s=c),l===r[c][this.parent.cardSettings.headerField].toString()&&(d=c);for(c=i.length;c<2*n;c++){var p=s===r.length-1,h=s<r.length?s+1:d-1;if(h<=r.length){var u=r[h];if(!(0,t.isNullOrUndefined)(u)){var g=this.renderCard(u);this.triggerCardRendering(g,h,r,a,p),p?d=h:s=h}}}}}},n.prototype.triggerCardRendering=function(e,n,r,a,i){var o=this,l=r[n][this.parent.cardSettings.headerField];-1!==this.parent.actionModule.selectionArray.indexOf(l)&&(e.setAttribute("aria-selected","true"),(0,t.addClass)([e],tt));var s={data:r[n],element:e,cancel:!1};this.parent.trigger(p,s,(function(n){n.cancel||(i?a.insertBefore(e,a.querySelectorAll("."+Ce)[0]):a.appendChild(e),o.parent.dragAndDropModule.wireDragEvents(e),(0,t.addClass)([e],we))}))},n.prototype.ensureBlocks=function(e){var t=e.newBlockIndex[e.block],n=Math.ceil(e.totalColumnData/e.singleIndexCardCount),r=Math.max;return("down"===e.scrollDirection?t>=n?[r(t,1),--t,--t].reverse():t+1>=n?[r(t-1,1),t,++t]:[r(t,1),++t,++t]:t===n?[r(t-2,1),r(t-1,1),t]:[r(t-1,1),t,t+1]).filter((function(e){return e>0}))},n.prototype.getInfoFromView=function(e){var t=!1,n=e;n.page=this.getPageFromTop(e),n.newBlockIndex=this.getBlockIndexes(n.page);var r=this.ensureBlocks(n);if(n.newBlockIndex.toString()!==r.toString()){var a=r[r.length-1];-1===n.newBlockIndex.indexOf(a)&&(t=!0)}return n.newBlockIndex=t?r:n.newBlockIndex,n},n.prototype.getBlockIndexes=function(e){return[e+(e-1),2*e]},n.prototype.getPageFromTop=function(e){var t=this,n=e.totalColumnData,r=0;return this.offsetKeys=Object.keys(e.offsets),this.offsetKeys.some((function(a){var i=Number(a),o=e.currentScrollTop<=e.offsets[parseInt(a,10)]||i===n&&e.currentScrollTop>e.offsets[parseInt(a,10)];if(o){var l=Math.ceil(n/e.singleIndexCardCount);t.offsetKeys.length%2!=0&&i.toString()===t.offsetKeys[t.offsetKeys.length-2]&&e.currentScrollTop<=e.offsets[t.offsetKeys.length-1]&&(i=i+1>l?l:i+1),i=i>l?l:i,e.block=i%2==0?1:0,r=Math.max(1,Math.min(t.getPage(i,l),l))}return o})),r},n.prototype.getPage=function(e,t){return e+1>t?e%2==0?e/2:(e-1)/2:e%2==0?e/2:(e+1)/2},n.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},n.prototype.isColumnVisible=function(e){var t=this,n=!1;return"number"==typeof e.keyField?n=-1===this.parent.actionModule.hideColumnKeys.indexOf(e.keyField.toString()):e.keyField.split(",").forEach((function(e){n=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)})),n},n.prototype.renderLimits=function(e,n){var r=(0,t.createElement)("div",{className:dt});e.minCount&&r.appendChild((0,t.createElement)("div",{className:pt,innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&r.appendChild((0,t.createElement)("div",{className:ct,innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),r.childElementCount>0&&(n.querySelector("."+be)?n.insertBefore(r,n.firstElementChild):n.appendChild(r))},n.prototype.renderValidation=function(){var e=this;this.parent.columns.forEach((function(n){if(n.minCount||n.maxCount){var r=e.columnData[n.keyField],a='[data-key="'+n.keyField+'"]',i=e.parent.element.querySelector("."+(ne+a)),o=[].slice.call(e.parent.element.querySelectorAll("."+(de+a)));e.renderLimits(n,i);var l=e.getValidationClass(n,r.length);l&&(0,t.addClass)(o.concat(i),l)}}))},n.prototype.getValidationClass=function(e,t){var n;return e.maxCount&&t>e.maxCount?n=ht:e.minCount&&t<e.minCount&&(n=ut),n},n.prototype.refreshValidation=function(){[].slice.call(this.parent.element.querySelectorAll("."+dt)).forEach((function(e){(0,t.remove)(e)}));var e=[].slice.call(this.parent.element.querySelectorAll("."+ut));(0,t.removeClass)(e,ut);var n=[].slice.call(this.parent.element.querySelectorAll("."+ht));(0,t.removeClass)(n,ht),this.renderValidation()},n.prototype.getColumnData=function(e,t){var n=this;void 0===t&&(t=this.parent.kanbanData);var r=[];if("number"==typeof e){var a=t.filter((function(t){return t[n.parent.keyField]===e}));r=r.concat(a)}else for(var i=function(e){var a=t.filter((function(t){return t[n.parent.keyField]===e.trim()}));r=r.concat(a)},o=0,l=e.split(",");o<l.length;o++){i(l[o])}return this.sortCategory(r),r},n.prototype.sortCategory=function(e){var t=this.parent.cardSettings.headerField,n=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":this.sortOrder(t,n,e);break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field),this.sortOrder(t,n,e)}return e},n.prototype.sortOrder=function(e,t,n){var r,a,i=!0;return this.parent.kanbanData.length>0&&(i="number"==typeof this.parent.kanbanData[0][e]),i||"Index"!==this.parent.sortSettings.sortBy?(n=n.sort((function(t,n){return i?(r=t[e],a=n[e]):(r=t[e].toLowerCase(),a=n[e].toLowerCase()),r>a?1:a>r?-1:0})),"Descending"===t&&n.reverse(),n):n},n.prototype.documentClick=function(e){if(e.target.classList.contains(ot)&&this.parent.element.querySelector("."+st).classList.contains("e-popup-open")&&(this.treePopup.hide(),(0,t.removeClass)([this.popupOverlay],"e-enable")),!(0,t.closest)(e.target,"."+Y)){var n=[].slice.call(this.parent.element.querySelectorAll("."+Ce+"."+tt));(0,t.removeClass)(n,tt),this.disableAttributeSelection(n)}},n.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach((function(e){e.setAttribute("aria-selected","false")}))},n.prototype.getColumnCards=function(e){var t=this,n={};return this.columnKeys=[],this.parent.columns.forEach((function(r){var a="number"==typeof r.keyField;t.columnKeys=a?t.columnKeys.concat(r.keyField.toString()):t.columnKeys.concat(r.keyField.split(",").map((function(e){return e.trim()})));var i=t.getColumnData(r.keyField,e);n[r.keyField]=i})),n},n.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector("."+ee);[].slice.call(e.children).forEach((function(e){return(0,t.remove)(e)})),this.renderHeader(e)},n.prototype.refreshCards=function(){this.parent.resetTemplates(["cardTemplate"]),[].slice.call(this.parent.element.querySelectorAll("."+Se)).forEach((function(e){return(0,t.remove)(e)})),this.renderCards(),this.wireDragEvent(),this.parent.renderTemplates()},n.prototype.refresh=function(){var e=this,t=!1;this.parent.columns.forEach((function(n){if(n.showItemCount){n&&n.template&&!t&&(e.refreshHeaders(),t=!0);var r="."+ne+'[data-key="'+n.keyField+'"] .'+ve,a=e.parent.element.querySelector(r);if(a){var i=e.parent.dataModule.isRemote()?e.parent.columnDataCount[n.keyField]:e.columnData[n.keyField].length,o=0;if("number"==typeof n.keyField)o=[].slice.call(e.parent.element.querySelectorAll("."+Ce+'[data-key="'+n.keyField+'"]')).length;else for(var l=0,s=n.keyField.split(",");l<s.length;l++){var d=s[l];o=[].slice.call(e.parent.element.querySelectorAll("."+Ce+'[data-key="'+d.trim()+'"]')).length+o}a.innerHTML="- "+i+" "+e.parent.localeObj.getConstant("items")}}})),this.refreshValidation()},n.prototype.updateScrollPosition=function(){var e=this,n=this.parent.element.querySelector("."+ce);n&&(t.Browser.isIE?(n.scrollTop=this.parent.scrollPosition.content.top,n.scrollLeft=this.parent.scrollPosition.content.left):n.scrollTo(this.parent.scrollPosition.content.left,this.parent.scrollPosition.content.top)),[].slice.call(this.parent.element.querySelectorAll("."+be)).forEach((function(n){if(n.offsetParent){var r=e.parent.scrollPosition.column[n.offsetParent.getAttribute("data-key")];r&&(t.Browser.isIE?(n.scrollTop=r.top,n.scrollLeft=r.left):n.scrollTo(r.left,r.top))}}))},n.prototype.renderCardBasedOnIndex=function(e,n,r,a){var i=this,o=e[this.parent.keyField],l=this.parent.element.querySelector(".e-content-row:not(.e-swimlane-row)");if("Index"!==this.parent.sortSettings.sortBy){var s=this.parent.cardSettings.headerField;if("Custom"===this.parent.sortSettings.sortBy&&(s=this.parent.sortSettings.field),(0,t.isNullOrUndefined)(this.parent.swimlaneSettings.keyField))n=this.getColumnData(o,this.parent.kanbanData).findIndex((function(t){return t[s]===e[s]}));else{var d=this.parent.getSwimlaneData(e[this.parent.swimlaneSettings.keyField]);n=this.getColumnData(o,d).findIndex((function(t){return t[s]===e[s]}))}}else"Index"===this.parent.sortSettings.sortBy&&this.parent.sortSettings.field&&"Ascending"===this.parent.sortSettings.direction&&(n=e[this.parent.sortSettings.field]-1);if(l){var c=[].slice.call(l.children).filter((function(e){return-1!==e.getAttribute("data-key").replace(/\s/g,"").split(",").indexOf(o.toString().replace(/\s/g,""))}))[0],h=c.querySelector("."+Se),u=h.querySelector("."+Le);u&&(0,t.remove)(u);var g=this.renderCard(e);this.parent.allowDragAndDrop&&c.classList.contains(Ee)&&(this.parent.dragAndDropModule.wireDragEvents(g),(0,t.addClass)([g],we));var m={data:e,element:g,cancel:!1};this.parent.trigger(p,m,(function(e){var l=!!r||h.childNodes.length<i.scrollStatus[o].singleIndexCardCount;(!e.cancel&&l||!(0,t.isNullOrUndefined)(a))&&((0,t.isNullOrUndefined)(n)||0===h.children.length?h.appendChild(g):h.insertBefore(g,h.childNodes[n]))}))}},n.prototype.removeCard=function(e){var n=e[this.parent.cardSettings.headerField],r=this.parent.element.querySelector("."+Ce+'[data-id="'+n+'"]');if(r){this.isSelectedCard=!!r.classList.contains(tt);var a=r.parentElement;(0,t.remove)(r),0===a.querySelectorAll("."+Ce+":not(."+We+")").length&&a.appendChild(this.renderEmptyCard())}},n.prototype.wireEvents=function(){var e=this;t.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),t.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),t.EventHandler.add(document,t.Browser.touchStartEvent,this.documentClick,this),window.addEventListener("resize",this.winResize);var n=this.parent.element.querySelector("."+ce);t.EventHandler.add(n,"scroll",this.onContentScroll,this),[].slice.call(this.parent.element.querySelectorAll("."+be)).forEach((function(n){e.parent.isInitialRender&&n.offsetParent&&(e.parent.scrollPosition.column[n.offsetParent.getAttribute("data-key")]={left:0,top:0}),t.EventHandler.add(n,"scroll",e.onColScrollShowSkeleton,e),t.EventHandler.add(n,"scroll",(0,t.debounce)(e.onColumnScroll,200),e)})),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),n.scrollLeft=this.scrollLeft),this.wireDragEvent()},n.prototype.unWireEvents=function(){var e=this;t.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),t.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),t.EventHandler.remove(document,t.Browser.touchStartEvent,this.documentClick),window.removeEventListener("resize",this.winResize),this.winResize=null;var n=this.parent.element.querySelector("."+ce);n&&(t.EventHandler.remove(n,"scroll",this.onContentScroll),t.EventHandler.remove(n,"scroll",this.onColScrollShowSkeleton),this.parent.allowDragAndDrop&&this.unWireDragEvent());var r=[].slice.call(this.parent.element.querySelectorAll("."+be));r.length>0&&r.forEach((function(n){t.EventHandler.remove(n,"scroll",(0,t.debounce)(e.onColumnScroll,200))})),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},n.prototype.wireDragEvent=function(){var e=this;if(this.parent.allowDragAndDrop){var n=[].slice.call(this.parent.element.querySelectorAll("."+de+"."+Ee+" ."+Ce));(0,t.addClass)(n,we),n.length>0&&n.forEach((function(t){return e.parent.dragAndDropModule.wireDragEvents(t)}))}},n.prototype.unWireDragEvent=function(){var e=this,n=[].slice.call(this.parent.element.querySelectorAll("."+de+"."+Ee+" ."+Ce));(0,t.removeClass)(n,we),n.length>0&&n.forEach((function(t){return e.parent.dragAndDropModule.unWireDragEvents(t)}))},n.prototype.destroy=function(){this.parent.resetTemplates(),this.parent.off(w,this.initRender),this.parent.off(C,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector("."+ee);e&&(0,t.remove)(e);var n=this.parent.element.querySelector("."+ce);n&&(0,t.remove)(n),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var r=this.parent.element.querySelector("."+rt);r&&(0,t.remove)(r);var a=this.parent.element.querySelector("."+lt);a&&(0,t.remove)(a)},n}(jt),Nt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ht=function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},It=function(e){function r(t,n){var r=e.call(this,t,n)||this;return r.columnDataCount={},r.needsID=!0,r}return Nt(r,e),r.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.kanbanData=[],this.enablePersistence&&this.swimlaneToggleArray||(this.swimlaneToggleArray=[]),this.activeCardData={data:null,element:null};this.localeObj=new t.L10n(this.getModuleName(),{items:"items",min:"Min",max:"Max",cardsSelected:"Cards Selected",addTitle:"Add New Card",editTitle:"Edit Card Details",deleteTitle:"Delete Card",deleteContent:"Are you sure you want to delete this card?",save:"Save",delete:"Delete",cancel:"Cancel",yes:"Yes",no:"No",close:"Close",noCard:"No cards to display",unassigned:"Unassigned",cards:"Cards"},this.locale),this.scrollPosition={content:{left:0,top:0},column:{}},this.isInitialRender=!0},r.prototype.requiredModules=function(){return[]},r.prototype.getPersistData=function(){return this.dataSource.length>0?this.addOnPersist(["columns","dataSource","swimlaneToggleArray"]):this.addOnPersist(["columns","kanbanData","swimlaneToggleArray"])},r.prototype.getModuleName=function(){return"kanban"},r.prototype.render=function(){var e=[Y],r=[];this.enableRtl?e.push(Q):r.push(Q),this.isAdaptive?e.push(X):r.push(X),this.cssClass&&e.push(this.cssClass),(0,t.classList)(this.element,e,r),this.element.style.width=(0,t.formatUnit)(this.width),this.element.style.height=(0,t.formatUnit)(this.height),this.element.setAttribute("role","application"),this.element.setAttribute("aria-label","Kanban Board"),(0,n.createSpinner)({target:this.element}),this.showSpinner(),this.initializeModules()},r.prototype.onPropertyChanged=function(e,n){for(var r=0,a=Object.keys(e);r<a.length;r++){switch(a[r]){case"cssClass":n.cssClass&&(0,t.removeClass)([this.element],n.cssClass),e.cssClass&&(0,t.addClass)([this.element],e.cssClass);break;case"enableRtl":case"locale":this.refresh();break;case"width":this.element.style.width=(0,t.formatUnit)(e.width),this.element.querySelector("."+ee).firstElementChild.style.width="auto",this.notify(C,{});break;case"height":this.element.style.height=(0,t.formatUnit)(e.height),this.element.querySelector("."+ce).style.height="auto",this.notify(C,{});break;case"dataSource":case"query":this.dataModule&&this.dataModule.setState({isDataChanged:!1}),this.dataModule=new A(this);break;case"columns":case"constraintType":case"sortSettings":this.notify(w,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,n.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,n.cardSettings);break;case"allowDragAndDrop":e.allowDragAndDrop?this.enableVirtualization?this.virtualLayoutModule.wireDragEvent():this.layoutModule.wireDragEvent():this.enableVirtualization?this.virtualLayoutModule.unWireDragEvent():this.layoutModule.unWireDragEvent();break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new At(this),this.enableVirtualization?this.virtualLayoutModule.refreshCards():this.layoutModule.refreshCards());break;case"dialogSettings":e.dialogSettings&&(this.dialogModule=new xt(this));break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new Dt(this));break;case"stackedHeaders":this.enableVirtualization?this.virtualLayoutModule.refreshHeaders():this.layoutModule.refreshHeaders()}}},r.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){switch(r[n]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortDirection":this.notify(w,{processedData:this.kanbanData});break;case"enableFrozenRows":this.layoutModule.frozenSwimlaneRow&&!this.swimlaneSettings.enableFrozenRows&&this.layoutModule.removeFrozenRows()}}},r.prototype.onCardSettingsPropertyChanged=function(e,n){for(var r=[],a=0,i=Object.keys(e);a<i.length;a++){switch(i[a]){case"showHeader":case"headerField":case"contentField":case"template":case"tagsField":case"grabberField":case"footerCssField":this.enableVirtualization?this.virtualLayoutModule.refreshCards():this.layoutModule.refreshCards();break;case"selectionType":(r=this.getSelectedCards()).length>0&&((0,t.removeClass)(r,tt),this.enableVirtualization?this.virtualLayoutModule.disableAttributeSelection(r):this.layoutModule.disableAttributeSelection(r))}}},r.prototype.initializeModules=function(){this.dataModule=new A(this),this.enableVirtualization?this.virtualLayoutModule=new Pt(this):this.layoutModule=new Rt(this),this.allowKeyboard&&(this.keyboardModule=new Dt(this)),this.actionModule=new Ct(this),this.crudModule=new wt(this),this.dragAndDropModule=new Et(this),this.dialogModule=new xt(this),this.enableTooltip&&(this.tooltipModule=new At(this)),(t.Browser.isDevice||t.Browser.isTouch)&&(this.touchModule=new Mt(this))},r.prototype.renderTemplates=function(){this.isReact&&this.renderReactTemplates()},r.prototype.resetTemplates=function(e){this.isReact&&this.clearTemplate(e)},r.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),this.virtualLayoutModule&&(this.virtualLayoutModule.destroy(),this.virtualLayoutModule=null),this.dialogModule=null,this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},r.prototype.templateParser=function(e){if(e)try{return"function"==typeof e?(0,t.compile)(e):document.querySelectorAll(e).length?(0,t.compile)(document.querySelector(e).innerHTML.trim()):(0,t.compile)(e)}catch(n){return(0,t.compile)(e)}},r.prototype.getCardDetails=function(e){var t=this,n="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter((function(e){return e[t.cardSettings.headerField]===n}))[0]},r.prototype.getColumnData=function(e,t){return this.enableVirtualization?this.virtualLayoutModule.getColumnCards(t)[""+e]||[]:this.layoutModule.getColumnCards(t)[""+e]||[]},r.prototype.getSwimlaneData=function(e){return this.layoutModule.getSwimlaneCards()[""+e]||[]},r.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll("."+Ce+"."+tt))},r.prototype.showSpinner=function(){(0,n.showSpinner)(this.element)},r.prototype.hideSpinner=function(){(0,n.hideSpinner)(this.element)},r.prototype.openDialog=function(e,t){this.dialogModule.openDialog(e,t)},r.prototype.closeDialog=function(){this.dialogModule.closeDialog()},r.prototype.addCard=function(e,t){this.crudModule.addCard(e,t)},r.prototype.updateCard=function(e,t){this.crudModule.updateCard(e,t)},r.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},r.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},r.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},r.prototype.showColumn=function(e){this.actionModule.showColumn(e)},r.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},r.prototype.refreshUI=function(e,t){t=t||0,this.dataModule.refreshUI(e,t)},r.prototype.refreshHeader=function(){this.resetTemplates(["columnTemplate"]),this.enableVirtualization?this.virtualLayoutModule.refreshHeaders():this.layoutModule.refreshHeaders(),this.renderTemplates()},r.prototype.destroy=function(){this.destroyModules(),[].slice.call(this.element.childNodes).forEach((function(e){(0,t.detach)(e)}));var n=[Y];this.cssClass&&(n=n.concat(this.cssClass.split(" "))),(0,t.removeClass)([this.element],n),e.prototype.destroy.call(this)},Ht([(0,t.Property)()],r.prototype,"cssClass",void 0),Ht([(0,t.Property)("auto")],r.prototype,"width",void 0),Ht([(0,t.Property)("auto")],r.prototype,"height",void 0),Ht([(0,t.Property)("auto")],r.prototype,"cardHeight",void 0),Ht([(0,t.Property)()],r.prototype,"enableVirtualization",void 0),Ht([(0,t.Property)([])],r.prototype,"dataSource",void 0),Ht([(0,t.Property)()],r.prototype,"query",void 0),Ht([(0,t.Property)()],r.prototype,"keyField",void 0),Ht([(0,t.Property)("Column")],r.prototype,"constraintType",void 0),Ht([(0,t.Property)([])],r.prototype,"externalDropId",void 0),Ht([(0,t.Collection)([],B)],r.prototype,"columns",void 0),Ht([(0,t.Property)(!0)],r.prototype,"allowKeyboard",void 0),Ht([(0,t.Property)(!0)],r.prototype,"enableHtmlSanitizer",void 0),Ht([(0,t.Collection)([],V)],r.prototype,"stackedHeaders",void 0),Ht([(0,t.Complex)({},T)],r.prototype,"swimlaneSettings",void 0),Ht([(0,t.Complex)({},R)],r.prototype,"cardSettings",void 0),Ht([(0,t.Complex)({},W)],r.prototype,"sortSettings",void 0),Ht([(0,t.Complex)({},N)],r.prototype,"dialogSettings",void 0),Ht([(0,t.Property)(!0)],r.prototype,"allowDragAndDrop",void 0),Ht([(0,t.Property)(!1)],r.prototype,"enableTooltip",void 0),Ht([(0,t.Property)(!1)],r.prototype,"showEmptyColumn",void 0),Ht([(0,t.Property)(!1)],r.prototype,"enablePersistence",void 0),Ht([(0,t.Property)()],r.prototype,"tooltipTemplate",void 0),Ht([(0,t.Event)()],r.prototype,"actionBegin",void 0),Ht([(0,t.Event)()],r.prototype,"actionComplete",void 0),Ht([(0,t.Event)()],r.prototype,"actionFailure",void 0),Ht([(0,t.Event)()],r.prototype,"created",void 0),Ht([(0,t.Event)()],r.prototype,"dataBinding",void 0),Ht([(0,t.Event)()],r.prototype,"dataBound",void 0),Ht([(0,t.Event)()],r.prototype,"cardClick",void 0),Ht([(0,t.Event)()],r.prototype,"cardDoubleClick",void 0),Ht([(0,t.Event)()],r.prototype,"queryCellInfo",void 0),Ht([(0,t.Event)()],r.prototype,"cardRendered",void 0),Ht([(0,t.Event)()],r.prototype,"dragStart",void 0),Ht([(0,t.Event)()],r.prototype,"drag",void 0),Ht([(0,t.Event)()],r.prototype,"dragStop",void 0),Ht([(0,t.Event)()],r.prototype,"dialogOpen",void 0),Ht([(0,t.Event)()],r.prototype,"dialogClose",void 0),Ht([(0,t.Event)()],r.prototype,"dataStateChange",void 0),Ht([(0,t.Event)()],r.prototype,"dataSourceChanged",void 0),r=Ht([t.NotifyPropertyChanges],r)}(t.Component)})(),c})()));